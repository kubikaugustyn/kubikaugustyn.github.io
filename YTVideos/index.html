<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Youtube videos</title>
</head>
<body>
<noscript>You must enable JavaScript in your browser.</noscript>
<button onclick="loadNext()">Start</button>
<!--<button onclick="loadNext()">Load next 64</button>
<button onclick="OK()">OK</button>-->
<input id="canDo" value="1">
<div id="videoID"></div>
<div id="root" style="display: none"></div>
<script>
    var ID, ind
    var rootDiv = document.getElementById("root")
    var oneCharsFromID = "abcdefghijklmnopqrstuvwxyz"
    oneCharsFromID = oneCharsFromID + oneCharsFromID.toUpperCase()
    oneCharsFromID += "0123456789"
    oneCharsFromID += "_-"
    console.log(oneCharsFromID.length)

    var defaultIDIndexes = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    //var defaultIDIndexes = [44, 37, 32, 45, 41, 37, 46, 3, 13, 53, 0]
    var IDIndexes = localStorage.getItem("IDIndexes") ? JSON.parse(localStorage.getItem("IDIndexes")) : defaultIDIndexes

    var IDs = []

    function loadNext() {
        rootDiv.innerHTML = ""
        for (var i = 0; i < oneCharsFromID.length; i++) {
            var oneCharFromID = oneCharsFromID[i]
            ID = ""
            for (ind in IDIndexes) {
                ID += oneCharsFromID[IDIndexes[ind]]
            }
            loadIMG(ID)
            document.getElementById("videoID").innerHTML = ID
            IDIndexes[10]++
        }
        IDIndexes[10] = 0
        IDIndexes[9]++
        localStorage.setItem("IDIndexes", JSON.stringify(IDIndexes))
        IDIndexes = localStorage.getItem("IDIndexes") ? JSON.parse(localStorage.getItem("IDIndexes")) : defaultIDIndexes
        ID = ""
        for (ind in IDIndexes) {
            ID += oneCharsFromID[IDIndexes[ind]]
        }
        console.clear()
        console.log(ID)
        OK()
    }

    function imageExists(image_url) {
        var http = new XMLHttpRequest();
        http.open('HEAD', image_url, false);
        http.send();
        return http.status !== 404;
    }

    function loadIMG(ID) {
        if (imageExists("https://i.ytimg.com/vi/" + ID + "/hqdefault.jpg")) {
            IDs.push(ID)
            rootDiv.innerHTML += "<button id='" + ID + "' onclick='myRemove(`" + ID + "`)'><img src='https://i.ytimg.com/vi/" + ID + "/hqdefault.jpg' alt='Image'></button>"
            //"https://i.ytimg.com/vi/"+ID+"/hqdefault.jpg"
        }
    }

    function myRemove(id) {
        for (var i = 0; i < IDs.length; i++) {

            if (IDs[i] === id) {

                IDs.splice(i, 1);
            }

        }
        document.getElementById(id).style.display = "none"
        return "Removed."
    }

    function OK() {
        var storedIDs = localStorage.getItem("IDs") ? JSON.parse(localStorage.getItem("IDs")) : []
        storedIDs = storedIDs.concat(IDs)
        localStorage.setItem("IDs", JSON.stringify(storedIDs))
        rootDiv.innerHTML = ""
        if (document.getElementById("canDo").value === "1") {
            loadNext()
        }
    }
</script>
</body>
</html>
