{"id":"xmAf","dependencies":[{"name":"C:\\Users\\Radek Augustyn\\Desktop\\Kubik\\MujWeb\\NodeApps\\Prihlasovani01\\package.json","includedInParent":true,"mtime":1579542458413},{"name":"passport-local","loc":{"line":5,"column":30},"parent":"C:\\Users\\Radek Augustyn\\Desktop\\Kubik\\MujWeb\\NodeApps\\Prihlasovani01\\config\\passport.js","resolved":"C:\\Users\\Radek Augustyn\\Desktop\\Kubik\\MujWeb\\NodeApps\\Prihlasovani01\\node_modules\\passport-local\\lib\\index.js"},{"name":"bcryptjs","loc":{"line":6,"column":23},"parent":"C:\\Users\\Radek Augustyn\\Desktop\\Kubik\\MujWeb\\NodeApps\\Prihlasovani01\\config\\passport.js","resolved":"C:\\Users\\Radek Augustyn\\Desktop\\Kubik\\MujWeb\\NodeApps\\Prihlasovani01\\node_modules\\bcryptjs\\dist\\bcrypt.js"},{"name":"../models/User","loc":{"line":9,"column":21},"parent":"C:\\Users\\Radek Augustyn\\Desktop\\Kubik\\MujWeb\\NodeApps\\Prihlasovani01\\config\\passport.js","resolved":"C:\\Users\\Radek Augustyn\\Desktop\\Kubik\\MujWeb\\NodeApps\\Prihlasovani01\\models\\User.js"}],"generated":{"js":"var e=require(\"passport-local\").Strategy,r=require(\"bcryptjs\"),n=require(\"../models/User\");module.exports=function(i){i.use(new e({usernameField:\"email\"},function(e,i,s){n.findOne({email:e}).then(function(e){if(!e)return s(null,!1,{message:\"That email is not registered\"});r.compare(i,e.password,function(r,n){if(r)throw r;return n?s(null,e):s(null,!1,{message:\"Password incorrect\"})})})})),i.serializeUser(function(e,r){r(null,e.id)}),i.deserializeUser(function(e,r){n.findById(e,function(e,n){r(e,n)})})};"},"sourceMaps":{"js":{"mappings":[{"source":"config/passport.js","original":{"line":5,"column":0},"generated":{"line":1,"column":0}},{"source":"config/passport.js","name":"LocalStrategy","original":{"line":5,"column":6},"generated":{"line":1,"column":4}},{"source":"config/passport.js","name":"require","original":{"line":5,"column":22},"generated":{"line":1,"column":6}},{"source":"config/passport.js","original":{"line":5,"column":30},"generated":{"line":1,"column":14}},{"source":"config/passport.js","name":"Strategy","original":{"line":5,"column":48},"generated":{"line":1,"column":32}},{"source":"config/passport.js","name":"bcrypt","original":{"line":6,"column":6},"generated":{"line":1,"column":41}},{"source":"config/passport.js","name":"require","original":{"line":6,"column":15},"generated":{"line":1,"column":43}},{"source":"config/passport.js","original":{"line":6,"column":23},"generated":{"line":1,"column":51}},{"source":"config/passport.js","name":"User","original":{"line":9,"column":6},"generated":{"line":1,"column":63}},{"source":"config/passport.js","name":"require","original":{"line":9,"column":13},"generated":{"line":1,"column":65}},{"source":"config/passport.js","original":{"line":9,"column":21},"generated":{"line":1,"column":73}},{"source":"config/passport.js","name":"module","original":{"line":11,"column":0},"generated":{"line":1,"column":91}},{"source":"config/passport.js","name":"exports","original":{"line":11,"column":7},"generated":{"line":1,"column":98}},{"source":"config/passport.js","original":{"line":11,"column":17},"generated":{"line":1,"column":106}},{"source":"config/passport.js","name":"passport","original":{"line":11,"column":26},"generated":{"line":1,"column":115}},{"source":"config/passport.js","name":"passport","original":{"line":12,"column":2},"generated":{"line":1,"column":118}},{"source":"config/passport.js","name":"use","original":{"line":12,"column":11},"generated":{"line":1,"column":120}},{"source":"config/passport.js","original":{"line":13,"column":4},"generated":{"line":1,"column":124}},{"source":"config/passport.js","name":"LocalStrategy","original":{"line":13,"column":8},"generated":{"line":1,"column":128}},{"source":"config/passport.js","original":{"line":13,"column":22},"generated":{"line":1,"column":130}},{"source":"config/passport.js","name":"usernameField","original":{"line":13,"column":24},"generated":{"line":1,"column":131}},{"source":"config/passport.js","original":{"line":13,"column":39},"generated":{"line":1,"column":145}},{"source":"config/passport.js","original":{"line":13,"column":50},"generated":{"line":1,"column":154}},{"source":"config/passport.js","name":"email","original":{"line":13,"column":51},"generated":{"line":1,"column":163}},{"source":"config/passport.js","name":"password","original":{"line":13,"column":58},"generated":{"line":1,"column":165}},{"source":"config/passport.js","name":"done","original":{"line":13,"column":68},"generated":{"line":1,"column":167}},{"source":"config/passport.js","name":"User","original":{"line":15,"column":6},"generated":{"line":1,"column":170}},{"source":"config/passport.js","name":"findOne","original":{"line":15,"column":11},"generated":{"line":1,"column":172}},{"source":"config/passport.js","original":{"line":15,"column":19},"generated":{"line":1,"column":180}},{"source":"config/passport.js","name":"email","original":{"line":16,"column":8},"generated":{"line":1,"column":181}},{"source":"config/passport.js","name":"email","original":{"line":16,"column":15},"generated":{"line":1,"column":187}},{"source":"config/passport.js","name":"then","original":{"line":17,"column":9},"generated":{"line":1,"column":191}},{"source":"config/passport.js","original":{"line":17,"column":14},"generated":{"line":1,"column":196}},{"source":"config/passport.js","name":"user","original":{"line":17,"column":14},"generated":{"line":1,"column":205}},{"source":"config/passport.js","original":{"line":18,"column":12},"generated":{"line":1,"column":208}},{"source":"config/passport.js","name":"user","original":{"line":18,"column":13},"generated":{"line":1,"column":212}},{"source":"config/passport.js","name":"done","original":{"line":19,"column":17},"generated":{"line":1,"column":214}},{"source":"config/passport.js","name":"done","original":{"line":19,"column":17},"generated":{"line":1,"column":221}},{"source":"config/passport.js","original":{"line":19,"column":22},"generated":{"line":1,"column":223}},{"source":"config/passport.js","original":{"line":19,"column":28},"generated":{"line":1,"column":229}},{"source":"config/passport.js","original":{"line":19,"column":35},"generated":{"line":1,"column":231}},{"source":"config/passport.js","name":"message","original":{"line":19,"column":37},"generated":{"line":1,"column":232}},{"source":"config/passport.js","original":{"line":19,"column":46},"generated":{"line":1,"column":240}},{"source":"config/passport.js","name":"bcrypt","original":{"line":23,"column":8},"generated":{"line":1,"column":273}},{"source":"config/passport.js","name":"compare","original":{"line":23,"column":15},"generated":{"line":1,"column":275}},{"source":"config/passport.js","name":"password","original":{"line":23,"column":23},"generated":{"line":1,"column":283}},{"source":"config/passport.js","name":"user","original":{"line":23,"column":33},"generated":{"line":1,"column":285}},{"source":"config/passport.js","name":"password","original":{"line":23,"column":38},"generated":{"line":1,"column":287}},{"source":"config/passport.js","original":{"line":23,"column":48},"generated":{"line":1,"column":296}},{"source":"config/passport.js","name":"err","original":{"line":23,"column":49},"generated":{"line":1,"column":305}},{"source":"config/passport.js","name":"isMatch","original":{"line":23,"column":54},"generated":{"line":1,"column":307}},{"source":"config/passport.js","name":"err","original":{"line":24,"column":14},"generated":{"line":1,"column":310}},{"source":"config/passport.js","name":"err","original":{"line":24,"column":14},"generated":{"line":1,"column":313}},{"source":"config/passport.js","original":{"line":24,"column":19},"generated":{"line":1,"column":315}},{"source":"config/passport.js","name":"err","original":{"line":24,"column":25},"generated":{"line":1,"column":321}},{"source":"config/passport.js","name":"isMatch","original":{"line":25,"column":14},"generated":{"line":1,"column":323}},{"source":"config/passport.js","name":"isMatch","original":{"line":25,"column":14},"generated":{"line":1,"column":330}},{"source":"config/passport.js","name":"done","original":{"line":26,"column":19},"generated":{"line":1,"column":332}},{"source":"config/passport.js","original":{"line":26,"column":24},"generated":{"line":1,"column":334}},{"source":"config/passport.js","name":"user","original":{"line":26,"column":30},"generated":{"line":1,"column":339}},{"source":"config/passport.js","name":"done","original":{"line":28,"column":19},"generated":{"line":1,"column":342}},{"source":"config/passport.js","original":{"line":28,"column":24},"generated":{"line":1,"column":344}},{"source":"config/passport.js","original":{"line":28,"column":30},"generated":{"line":1,"column":350}},{"source":"config/passport.js","original":{"line":28,"column":37},"generated":{"line":1,"column":352}},{"source":"config/passport.js","name":"message","original":{"line":28,"column":39},"generated":{"line":1,"column":353}},{"source":"config/passport.js","original":{"line":28,"column":48},"generated":{"line":1,"column":361}},{"source":"config/passport.js","name":"passport","original":{"line":35,"column":2},"generated":{"line":1,"column":391}},{"source":"config/passport.js","name":"serializeUser","original":{"line":35,"column":11},"generated":{"line":1,"column":393}},{"source":"config/passport.js","original":{"line":35,"column":25},"generated":{"line":1,"column":407}},{"source":"config/passport.js","name":"user","original":{"line":35,"column":34},"generated":{"line":1,"column":416}},{"source":"config/passport.js","name":"done","original":{"line":35,"column":40},"generated":{"line":1,"column":418}},{"source":"config/passport.js","name":"done","original":{"line":36,"column":4},"generated":{"line":1,"column":421}},{"source":"config/passport.js","original":{"line":36,"column":9},"generated":{"line":1,"column":423}},{"source":"config/passport.js","name":"user","original":{"line":36,"column":15},"generated":{"line":1,"column":428}},{"source":"config/passport.js","name":"id","original":{"line":36,"column":20},"generated":{"line":1,"column":430}},{"source":"config/passport.js","name":"passport","original":{"line":39,"column":2},"generated":{"line":1,"column":436}},{"source":"config/passport.js","name":"deserializeUser","original":{"line":39,"column":11},"generated":{"line":1,"column":438}},{"source":"config/passport.js","original":{"line":39,"column":27},"generated":{"line":1,"column":454}},{"source":"config/passport.js","name":"id","original":{"line":39,"column":36},"generated":{"line":1,"column":463}},{"source":"config/passport.js","name":"done","original":{"line":39,"column":40},"generated":{"line":1,"column":465}},{"source":"config/passport.js","name":"User","original":{"line":40,"column":4},"generated":{"line":1,"column":468}},{"source":"config/passport.js","name":"findById","original":{"line":40,"column":9},"generated":{"line":1,"column":470}},{"source":"config/passport.js","name":"id","original":{"line":40,"column":18},"generated":{"line":1,"column":479}},{"source":"config/passport.js","original":{"line":40,"column":22},"generated":{"line":1,"column":481}},{"source":"config/passport.js","name":"err","original":{"line":40,"column":31},"generated":{"line":1,"column":490}},{"source":"config/passport.js","name":"user","original":{"line":40,"column":36},"generated":{"line":1,"column":492}},{"source":"config/passport.js","name":"done","original":{"line":41,"column":6},"generated":{"line":1,"column":495}},{"source":"config/passport.js","name":"err","original":{"line":41,"column":11},"generated":{"line":1,"column":497}},{"source":"config/passport.js","name":"user","original":{"line":41,"column":16},"generated":{"line":1,"column":499}}],"sources":{"config/passport.js":"/*\n    author Kubík Augustýn, kubik.augustyn@post.cz\n*/\n\nconst LocalStrategy = require('passport-local').Strategy;\nconst bcrypt = require('bcryptjs');\n\n// Load User model\nconst User = require('../models/User');\n\nmodule.exports = function(passport) {\n  passport.use(\n    new LocalStrategy({ usernameField: 'email' }, (email, password, done) => {\n      // Match user\n      User.findOne({\n        email: email\n      }).then(user => {\n        if (!user) {\n          return done(null, false, { message: 'That email is not registered' });\n        }\n\n        // Match password\n        bcrypt.compare(password, user.password, (err, isMatch) => {\n          if (err) throw err;\n          if (isMatch) {\n            return done(null, user);\n          } else {\n            return done(null, false, { message: 'Password incorrect' });\n          }\n        });\n      });\n    })\n  );\n\n  passport.serializeUser(function(user, done) {\n    done(null, user.id);\n  });\n\n  passport.deserializeUser(function(id, done) {\n    User.findById(id, function(err, user) {\n      done(err, user);\n    });\n  });\n};\n"},"lineCount":null}},"error":null,"hash":"893843d57b4acaea1d8cfab15530dc4b","cacheData":{"env":{}}}