"use strict";var ASC={},__awaiter=this&&this.__awaiter||function(t,o,a,l){return new(a=a||Promise)(function(e,i){function n(t){try{r(l.next(t))}catch(t){i(t)}}function s(t){try{r(l.throw(t))}catch(t){i(t)}}function r(t){t.done?e(t.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(t.value).then(n,s)}r((l=l.apply(t,o||[])).next())})},__generator=this&&this.__generator||function(i,n){var s,r,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,r&&(o=2&e[0]?r.return:e[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,e[1])).done)return o;switch(r=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,r=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],r=0}finally{s=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};!function(ASC){function windowOpenINP(t){if("chrome"==ASC.browser){var e=$j("<a target='_blank' rel='noreferrer'>").attr("href",t).text(t);e.appendTo(document.body),e[0].click(),e.remove()}else window.open(t)}function createChild(t,e,i,n){var s=document.createElement(e);return t.appendChild(s),i&&setClass(s,i),n&&(s.style.cssText=n),s}function createDiv(t,e,i){return ASC.createChild(t,"div",e,i)}function createSpan(t,e,i){return ASC.createChild(t,"span",e,i)}function createText(t,e){var i=document.createTextNode(e);return t.appendChild(i),i}function createSpanText(t,e,i,n){var s=ASC.createSpan(t,i,n);return ASC.createText(s,e),s}function createAnchor(t,e,i,n,s,r){var o=$j("<span>").appendTo(t).text(e).css({cursor:"pointer",textDecoration:"underline"}).click(n,function(t){i(t,t.data)});return s&&o.addClass(s),r&&(o.get(0).style.cssText+=r),o.get(0)}function createTable(t,e,i,n,s){var r={table:ASC.createChild(t,"table",n,s),tbody:null,rows:[],cells:[]};r.tbody=ASC.createChild(r.table,"tbody");for(var o=0;o<i;o++){r.cells[o]=[];var a=ASC.createChild(r.tbody,"tr");r.rows[o]=a;for(var l=0;l<e;l++)r.cells[o][l]=ASC.createChild(a,"td")}return r}function createMiniIcon(t,e,i){void 0===i&&(i={}),i=$j.extend({type:"edit"},i);var n=$j("<div>").addClass("mini "+i.type).css(i.right?"right":"left","0").hide();return $j(t).addClass("miniContainer").mouseover(function(t){n.show()}).mouseout(function(t){n.hide()}).click(function(t){e(t)}).append(n),n}function jscFieldsParams(t,e){for(var i="",n=0,s=e;n<s.length;n++){var r=s[n];t[r]&&(i+=(i?"&":"")+r+"="+encodeURIComponent(t[r].value))}return i}function jscSetFieldValue(t,e,i){var n=t[e];n&&(n.ASC_set?n.ASC_set(i):n.value=i)}function createUploadFile(t,n,s,r){var o=$j("<form>").appendTo(t).attr({id:"form_"+ASC_newId(),method:"post",enctype:"multipart/form-data"}).css("display","inline");o.append('<input type="file" name="uploadfile">');function e(t){if(0<o.parents("html").length){var e=new FormData(o.get(0)),i=n;s.params&&(i+="&"+jscFieldsParams(r,s.params)),ASC_action(i,e,$j.extend({timeout:72e5,cache:!1,global:!1,contentType:!1,processData:!1},s))}else o.remove()}return e.form=o,e.input=o.find("input"),o.find(":file").on("change submit",e),e}function setClass(t,e,i){void 0===i&&(i=!0),$j(t).toggleClass(e,!!i)}function type(t){var e={undefined:"undefined",number:"number",boolean:"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error"};return e[typeof t]||e[Object.prototype.toString.call(t)]||(t?"object":null)}function isArray(t){return!!t&&"array"===ASC.type(t)}function isString(t){return"string"===ASC.type(t)}function isJQuery(t){return!!(t.get&&t.on&&t.off)}function assert(t,e){if(void 0===e&&(e="Assertion failed"),!t)throw e}function strippedBackground(t,e,i,n,s){void 0===s&&(s=!1);var r="";if(s){var o=5;n&&(o=Math.min(n,o)),r="linear-gradient(rgba(255,255,255,0.5),rgba(0,0,0,0) "+o+"px)"}if(0<e.length&&(r?t.style.cssText=t.style.cssText+";background:"+r+","+e[0]:t.style.backgroundColor=e[0]),1<e.length){d=e[0];var a=45;3<=i&&3<=n&&(a=Math.atan2(n,i/(e.length-1))/Math.PI*180);for(var l="linear-gradient("+(180-a)+"deg,"+d,c=1;c<e.length;c++){var u=1/e.length*c;l+=","+d+" "+100*u+"%";var d=e[c];l+=","+d+" "+100*u+"%"}l+=")",r&&(l=r+","+l),t.style.cssText=t.style.cssText+";background:"+l}}function json_dc(t){var a=t[0],l=t[1],c=[],u=0,d=function(){var t=a[u++];switch(t){case-1:for(var e=a[u++],i=[],n=0;n<e;n++)i.push(d());return i;case-2:e=a[u++];var s={},r=[];for(n=0;n<e;n++)r.push(d());c.push(r);for(n=0;n<e;n++)s[r[n]]=d();return s;case-3:return[];case-4:return[d()];case-5:return[d(),d()]}if(t<0){for(r=c[-t-10],s={},n=0;n<r.length;n++)s[r[n]]=d();return s}var o=l[t];return ASC.isArray(o)&&(o=o.slice(0)),o};return d()}ASC.langasc={},ASC.ttlangasc={},ASC.loadedJSLibs=0,ASC.windowOpenINP=windowOpenINP,ASC.createChild=createChild,ASC.createDiv=createDiv,ASC.createSpan=createSpan,ASC.createText=createText,ASC.createSpanText=createSpanText,ASC.createAnchor=createAnchor,ASC.createTable=createTable,ASC.createMiniIcon=createMiniIcon,ASC.jscFieldsParams=jscFieldsParams,ASC.jscSetFieldValue=jscSetFieldValue,ASC.createUploadFile=createUploadFile,ASC.setClass=setClass,ASC.type=type,ASC.isArray=isArray,ASC.isString=isString,ASC.isJQuery=isJQuery,ASC.assert=assert,ASC.strippedBackground=strippedBackground,ASC.json_dc=json_dc;var timer_last=0;function timer_start(){timer_last=Date.now()}function timer_dump(t,e){var i=Date.now();console.log(t+"="+(i-timer_last)),e&&e.append("<br/>"+t+"="+(i-timer_last)),timer_last=i}ASC.timer_start=timer_start,ASC.timer_dump=timer_dump;var todo_read_buffer=[],todo_write_buffer=[];function todo(t){todo_read_buffer.push(t)}function todo_read(t){todo_read_buffer.push(t)}function todo_write(t){todo_write_buffer.push(t)}function todo_finish(){if(0!=todo_read_buffer.length||0!=todo_write_buffer.length){var t=todo_read_buffer;todo_read_buffer=[];for(var e=0;e<t.length;e++)t[e]();t=todo_write_buffer;todo_write_buffer=[];for(e=0;e<t.length;e++)t[e]();todo_finish()}}function todo_flipText(o,e,i,n){if(ASC.isArray(o))for(var t=0;t<o.length;t++)ASC.flipText(o[t],e,i,n);else todo_read(function(){var r=o.clientWidth;"get"===i&&(i=o.clientHeight),i=i||90,todo_write(function(){e||(e=ASC.textContent(o),o.innerHTML=""),todo_write(function(){var t=ASC.createDiv(o,"","width:"+i+"px;"),s=ASC.createDiv(t,"flip-text"+(n?" center":""),"");ASC.createText(s,e),todo_read(function(){var n=s.clientHeight;todo_write(function(){s.style.height=i+"px",isIE(9)&&(s.style.cssText+=";-ms-writing-mode:tb-lr;padding-top:1px;padding-left:0;"),window.getComputedStyle&&todo_read(function(){var t=window.getComputedStyle(o),e=ASC.getStyleValuePixels(t.paddingLeft),i=ASC.getStyleValuePixels(t.paddingRight);r-e-i<n&&todo_write(function(){r<n&&(s.style.lineHeight="85%",n*=.85);var t=Math.round(Math.min(r,n)),e=Math.round((r-t)/2),i=r-t-e;3!=e||3!=i&&2!=i||15!=t?(o.style.paddingLeft=e+"px",o.style.paddingRight=i+"px",o.style.width=t+"px"):$j(o).addClass("fix315")})})})})})})})}function flipText(t,e,i,n){todo_flipText(t,e,i,n),todo_finish()}function ls_skcz(t,e){return"cz"==ASC.lang?e:t}function ls_skczen(t,e,i){return"cz"==ASC.lang?e:"sk"==ASC.lang?t:i}function lang_getLocale(t){var e=(t=t||ASC.school_country||"en").toLowerCase();switch(t){case"cz":e="cs";break;case"at":e="de";break;case"us":e="en"}return e+"-"+t.toUpperCase()}function getSchoolYear(t){if(!t)throw new Error;var e=parseInt(t.substr(0,4));return t.substr(5)<ASC.schoolyear_turnover&&e--,e}function vyskrtni(t,e,i){void 0===e&&(e="/"),void 0===i&&(i=1);var n=$j(t);n.html(""),n.css("vertical-align","top"),n.css("overflow","hidden"),n.css("padding","0px");var s=1,r=t.offsetWidth,o=t.offsetHeight;0<r&&(s=Math.atan2(o,r),"\\"==e&&(s=-s),"-"==e&&(s=0)),$j("<div>").appendTo(t).css({borderTop:i+"px solid black",margin:(n.height()-i)/2+"px -100% 0% -100%",height:i+"px",transform:"rotate(-"+s+"rad)"})}function getCssCrossBrowser(t,e,i){var n={};return n[t]=i?e:"",n["-webkit-"+t]=n[t],n["-moz-"+t]=n[t],n["-ms-"+t]=n[t],n["-o-"+t]=n[t],n}ASC.todo=todo,ASC.todo_read=todo_read,ASC.todo_write=todo_write,ASC.todo_finish=todo_finish,ASC.todo_flipText=todo_flipText,ASC.flipText=flipText,ASC.ls_skcz=ls_skcz,ASC.ls_skczen=ls_skczen,ASC.lang_getLocale=lang_getLocale,ASC.getSchoolYear=getSchoolYear,ASC.vyskrtni=vyskrtni,ASC.getCssCrossBrowser=getCssCrossBrowser;var showContextMenu_menu=null;function showContextMenu(t,e,i){void 0===i&&(i={}),hideContextMenu();try{(i instanceof HTMLElement||ASC.isJQuery(i))&&(i={cd:i})}catch(t){i=$j.extend({},i,{cd:document.body})}if(i.handler){var n=function(t){if(ASC.isArray(t))for(var e=0;e<t.length;e++)n(t[e]);else t.cmd&&(t.onclick||(t.onclick=function(){i.handler(t)})),t.submenu&&n(t.submenu)};n(t)}var s=i.cd,r=$j(s).parents(".ui-front, .ui-dialog"),o={container:r.length?r:document.body,cssClass:i.cssClass};return void 0!==i.clickToHide&&(o.clickToHide=i.clickToHide),showContextMenu_menu=new ASC.ui.ContextMenu(t,o),i.header&&showContextMenu_menu.cfg.setProperty("header",i.header),i.footer&&showContextMenu_menu.cfg.setProperty("footer",i.footer),i.onHide&&(showContextMenu_menu.config.onHide=i.onHide),$j(document.body).click(hideContextMenu),showContextMenu_menu.show(s||e),e&&e.stopPropagation&&e.stopPropagation(),showContextMenu_menu}function showContextMenuOpened(t){return showContextMenu_menu&&showContextMenu_menu.$menu.is(":visible")&&(!t||showContextMenu_menu.$trigger.is(t))}function hideContextMenu(){showContextMenu_menu&&(showContextMenu_menu.hide(),showContextMenu_menu.destroy(),showContextMenu_menu=null)}function hidePopups(){hideContextMenu(),barHideAllDropDowns&&barHideAllDropDowns()}function dieError(t,e){throw console.error("Error",t),void 0!==e&&console.log(e),alert("ErrorJS: "+t),new Error(""+t)}function logProblem(t,e){console.error("Problem",t),void 0!==e&&console.log(e)}function logError(n,s){s=s&&JSON.stringify(s),$j.ajax({url:"/gcall",type:"POST",data:{logError:n,msg:s},timeout:6e4,global:!1,success:function(t,e,i){dieError(n,s)},error:function(t,e,i){console.log(t,e,i),alert("Error connecting to edupage:\n"+e)}})}function checkRequiredFields(t,e,i){for(var n,s,r={msg:ASC.ls(2724)},o=0,a=e;o<a.length;o++){var l=a[o],c=$j(t[l]);if(c.hasClass("required")&&!validateField(l,c.val(),r))return void 0!==i&&!i||(ASC.ascdebug&&console.log(l,c),ASC.flashMessage(r.msg,{border_error:(n=c,s=void 0,s=n[0].ASC_uiElement,s=s||(n.is(":hidden")?n.parent().get(0):n.get(0)))})),!1}return!0}function validateField(t,e,i){if(void 0===i&&(i={}),""!=e&&null!=e&&null!=e){if(!(0<=t.search("email"))||validatorEmail(e))return!0;i.msg=ASC.ls(3535)}return!1}function removeDiacritics(t){var i="Ăˇ=a,Ă=a,Ă¤=a,ÄŤ=c,ÄŚ=C,ÄŹ=d,ÄŽ=D,Ă©=e,Ă‰=E,Ă­=i,ĂŤ=I,Äş=l,Äą=L,Äľ=l,Ä˝=L,Ĺ=n,Ĺ‡=N,Ăł=o,Ă“=O,Ă´=o,Ă”=O,Ĺ•=r,Ĺ”=R,Ĺˇ=s,Ĺ =S,ĹĄ=t,Ĺ¤=T,Ăş=u,Ăš=U,Ă˝=y,Ăť=Y,Ĺľ=z,Ĺ˝=Z";return i+=",Ä…=a,Ä„=a,Ä‡=c,Ä†=C,Ä™=e,Ä=E,Ĺ‚=l,Ĺ=L,Ĺ„=n,Ĺ=N,Ăł=o,Ă“=O,Ĺ›=s,Ĺš=S,ĹĽ=z,Ĺ»=Z,Ĺş=z,Ĺą=Z",i+=",ĂĽ=u,Ăź=ss,Ă¶=o",i+=",Ĺ™=r,Ĺ=R",t.replace(/[ĂˇĂĂ¤ÄŤÄŚÄŹÄŽĂ©Ă‰Ă­ĂŤÄşÄąÄľÄ˝ĹĹ‡ĂłĂ“Ă´Ă”Ĺ•Ĺ”ĹˇĹ ĹĄĹ¤ĂşĂšĂ˝ĂťĹľĹ˝Ä…Ä„Ä‡Ä†Ä™ÄĹ‚ĹĹ„ĹĂłĂ“Ĺ›ĹšĹĽĹ»ĹşĹąĂĽĂźĂ¶Ĺ™Ĺ]/g,function(t){var e=i.search(t);return i.substr(e+2,i.indexOf(",",e+2)-e-2)})}function setFieldValidator(t,e){function i(){ASC.setClass(t,"asc-badfieldvalue",!e(t.value))}i(),$j(t).change(i),$j(t).keyup(i)}function validatorRC(t){if(""==t)return!0;if(!/^[0-9]{6}\/[0-9XY][0-9]{2,3}$/i.test(t))return!1;if("cz"==ASC.school_country){if(0<=t.indexOf("X"))return!0;if(0<=t.indexOf("Y"))return!0;if(t.substr(0,2)<="53"&&9==t.replace("/","").length)return!0}return parseInt(t.replace("/",""))%11==0}function validatorEmail(t){if(""==t)return!0;return/^([\w-+]+(?:\.[\w-+]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(t)&&(!t.endsWith||!t.endsWith("@gmail.sk")&&!t.endsWith("@gmail.cz")&&!t.endsWith("@gamil.com")&&!t.endsWith("@gmial.com")&&!t.endsWith("@gmal.com")&&!t.endsWith("@gmil.com")&&!t.endsWith("@gmali.com")&&!t.endsWith("@gmila.com")&&!t.endsWith("vgmail.com")&&!t.endsWith("vcentrum.sk"))}function validatorRequire(e){return"string"!=typeof e&&e.call?function(t){return""!=t&&e(t)}:""!=e}function isIE(t){if(ASC.browser&&"ie"==ASC.browser.substr(0,2))return!(6<t)||parseInt(ASC.browser.substr(2))<=t;var e=navigator.appVersion.indexOf("MSIE");if(-1==e)return!1;if(6<t){var i=navigator.appVersion.substr(e+4,5);return parseInt(i)<=t}return!0}function reloadPage(){window.location.reload()}function date_today(){return date_js2sql(new Date)}function date_delta(t,e){var i=date_sql2js(t);return date_js2sql(new Date(i.getTime()+864e5*e))}function date_diff(t,e){var i=date_sql2js(t).getTime()-date_sql2js(e).getTime();return Math.round(i/864e5)}function date_interval_array(t,e){for(var i=[],n=t;n<=e;n=date_delta(n,1))i.push(n),5e3<i.length&&ASC.dieError("3834191212");return i}function date_js2sql(t){var e=t.getDate(),i=t.getMonth()+1;return t.getFullYear()+"-"+(i<10?"0":"")+i+"-"+(e<10?"0":"")+e}function time_js2sql(t){var e=t.getHours(),i=t.getMinutes(),n=t.getSeconds();return(e<10?"0":"")+e+":"+(i<10?"0":"")+i+":"+(n<10?"0":"")+n}function datetime_js2sql(t){return ASC.date_js2sql(t)+" "+ASC.time_js2sql(t)}function date_sql2js(t){return t instanceof Date?new Date(t.toString()):new Date(parseInt(t.substr(0,4),10),parseInt(t.substr(5,2),10)-1,parseInt(t.substr(8,2),10),11)}function timezone_isWeekend(t){return!!t&&ASC.boolVal(ASC.timezone_isWeekend_day(ASC.date_sql2js(t).getDay()))}function ASC_date2str(t,e){if(void 0===e&&(e=!0),!t||""==t)return"";if((t=""+t).length<10)return t;var i=parseInt(t.substr(8,2),10),n=parseInt(t.substr(5,2),10),s=parseInt(t.substr(0,4),10),r=(i<10?"0":"")+i,o=(n<10?"0":"")+n;switch(ASC.lang){case"sk":case"cz":return i+". "+n+"."+(e?" "+s:"");case"de":return r+"."+o+"."+(e?s:"");case"pl":return i+"."+n+"."+(e?s:"");case"hu":return(e?s+".":"")+" "+n+". "+i;default:return"us"==ASC.school_country?n+"/"+i+(e?"/"+s:""):r+"/"+o+(e?"/"+s:"")}}function ASC_date2str_day(t){if(!t||""==t)return"";var e=parseInt(t.substr(8,2),10),i=parseInt(t.substr(5,2),10),n=parseInt(t.substr(0,4),10);return ASC.ui.DatePicker.getDayNamesShort()[new Date(n,i-1,e).getDay()]}function ASC_time2str(t,e){if(void 0===e&&(e={}),!t||""==t)return"";":"==t[1]&&(t="0"+t);var i=!!e.short,n=void 0===e.ajSekundy?!i:e.ajSekundy,s=parseInt(t.substr(0,2),10),r=parseInt(t.substr(3,2),10),o=parseInt(t.substr(6,2),10),a=(s<10?"0":"")+s,l=(r<10?"0":"")+r,c=(o<10?"0":"")+o;switch(ASC.lang){case"de":return a+":"+l+(n?":"+c:"");case"en":var u=":"+l+(n?":"+c:"");return 0==s?"12"+u+(i?"":" AM"):s<12?s+u+(i?"":" AM"):12==s?"12"+u+(i?"":" PM"):s-12+u+(i?"":" PM");default:return s+":"+l+(n?":"+c:"")}}function ASC_str2time(t){var e=t.split(":"),i=["00","00","00"];if(t){var n=e[e.length-1]+"",s=0;for(var r in e)s=parseInt(2<e[r].length?e[r].substr(0,2):e[r],10),isNaN(s)||(i[r]=(s<10?"0":"")+s);0<=n.toLowerCase().indexOf("pm")&&parseInt(i[0])<12&&(i[0]=""+(parseInt(i[0])+12)%24),0<=n.toLowerCase().indexOf("am")&&12==parseInt(i[0])&&(i[0]="00")}return i.join(":")}function currentTimeMillis(){return(new Date).getTime()}function date_week_end(t){return date_delta(date_week_start(t),6)}function date_week_start(t){for(var e=ASC.ui.DatePicker.getSettings().firstDay,i=date_sql2js(t),n=6;0<n&&i.getDay()!=e;n--)i.setDate(i.getDate()-1);return ASC.date_js2sql(i)}function ASC_monthName(t){return 0<=t&&t<ASC.ui.DatePicker.monthNames.length?ls(ASC.ui.DatePicker.monthNames[t]):t}function ASC_dayName(t){return 0<=t&&t<ASC.ui.DatePicker.dayNames.length?ls(ASC.ui.DatePicker.dayNames[t]):t}function date_firstDayOfWeek(t,e){var i;void 0===e&&(e=1);var n=!1;"date"==ASC.type(t)?(i=t,n=!0):i=ASC.date_sql2js(t);var s=i.getDay();return s!=e&&(s=s<e?i.getDate()-(6-s):i.getDate()-(s-e),i.setDate(s)),n?i:ASC.date_js2sql(i)}function date_week_getNumber(t){var e=ASC.date_sql2js(t);e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var i=new Date(e.getFullYear(),0,4);return 1+Math.round(((e.getTime()-i.getTime())/864e5-3+(i.getDay()+6)%7)/7)}function indexOf(t,e,i){void 0===i&&(i=0);for(var n=t.length;i<n;i++)if(i in t&&t[i]===e)return i;return-1}function indexOf2(t,e,i){void 0===i&&(i=0);for(var n=t.length;i<n;i++)if(i in t&&t[i]==e)return i;return-1}function remove(t,e){var i=ASC.indexOf(t,e);0<=i&&t.splice(i,1)}function trim(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function length(t){return t.length?parseInt(t.length):ASC.count(t)}function count(t){var e=0;if(t)for(var i in t)e++;return e}function strEquals(t,e){return""+t==""+e}function emailIsValid(t){if((t+="").length<5||t.indexOf("@")<0)return!1;return/^[a-zA-Z0-9]+[a-zA-Z0-9\._\-\+]*@([a-zA-Z0-9_\-]+\.)+[a-zA-Z]+$/i.test(t)}function loadTTLang(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return ASC.count(ASC.ttlangasc)<2e3?[2,new Promise(function(t){return barJsLibraryLoad("/langs/pics/js/ttlang_"+ASC.lang+".js?dummy=_5",t)})]:[2]})})}function ttls(t){return ASC.ttlangasc[t]?ASC.ttlangasc[t]:""+t}function ls(t){return Langs&&Langs[t]?Langs[t]:""+t}function lsf(t,e){var i=parseInt(t)?ls(parseInt(t)):t;if(e)for(var n in e){var s=e[n];for(i=i.replace("{"+n+"}",s);;){var r=i.indexOf("{"+n+":");if(!(0<=r))break;var o=r+2+n.length,a=i.indexOf("}",o),l=i.substring(o,a).split("|"),c=1;switch(ASC.lang){case"sk":case"cz":c=1==s?1:2<=s&&s<5?2:3;break;default:c=1==s?1:2;case"hr":var u=Math.abs(s);c=u%10==1&&u%100!=11?1:2<=u%10&&u%10<5&&(u%100<10||20<=u%100)?2:3}1==l.length&&(l=["",l[0],l[0]]),2==l.length&&(l=[l[0],l[1],l[1]]),i=i.substr(0,r)+l[c-1]+i.substr(a+1)}}return i}function clone(t){return JSON.parse(JSON.stringify(t))}function cloneArray(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}function ToString(t){if(null==t)return"";var e=""+t;switch(ASC.type(t)){case"object":for(var i in e="{",t)"{"!=e&&(e+=", "),e+=i+": "+ASC.ToString(t[i]);e+="}";break;case"array":e="";for(var n=0;n<t.length;n++)0<n&&(e+=", "),e+=ASC.ToString(t[n])}return e}function textContent(t){return $j(t).text()}function getStyleValuePixels(t){var e=t.length;return 2<e&&"px"==t.substr(e-2)?parseInt(t.substr(0,e-2)):0}ASC.showContextMenu=showContextMenu,ASC.showContextMenuOpened=showContextMenuOpened,ASC.hideContextMenu=hideContextMenu,ASC.hidePopups=hidePopups,ASC.dieError=dieError,ASC.logProblem=logProblem,ASC.logError=logError,ASC.checkRequiredFields=checkRequiredFields,ASC.validateField=validateField,ASC.removeDiacritics=removeDiacritics,ASC.setFieldValidator=setFieldValidator,ASC.validatorRC=validatorRC,ASC.validatorEmail=validatorEmail,ASC.validatorRequire=validatorRequire,ASC.isIE=isIE,ASC.reloadPage=reloadPage,ASC.date_today=date_today,ASC.date_delta=date_delta,ASC.date_diff=date_diff,ASC.date_interval_array=date_interval_array,ASC.date_js2sql=date_js2sql,ASC.time_js2sql=time_js2sql,ASC.datetime_js2sql=datetime_js2sql,ASC.date_sql2js=date_sql2js,ASC.timezone_isWeekend=timezone_isWeekend,ASC.ASC_date2str=ASC_date2str,ASC.ASC_date2str_day=ASC_date2str_day,ASC.ASC_time2str=ASC_time2str,ASC.ASC_str2time=ASC_str2time,ASC.currentTimeMillis=currentTimeMillis,ASC.date_week_end=date_week_end,ASC.date_week_start=date_week_start,ASC.ASC_monthName=ASC_monthName,ASC.ASC_dayName=ASC_dayName,ASC.date_firstDayOfWeek=date_firstDayOfWeek,ASC.date_week_getNumber=date_week_getNumber,ASC.indexOf=indexOf,ASC.indexOf2=indexOf2,ASC.remove=remove,ASC.trim=trim,ASC.length=length,ASC.count=count,ASC.strEquals=strEquals,ASC.emailIsValid=emailIsValid,ASC.loadTTLang=loadTTLang,ASC.ttls=ttls,ASC.ls=ls,ASC.lsf=lsf,ASC.clone=clone,ASC.cloneArray=cloneArray,ASC.ToString=ToString,ASC.textContent=textContent,ASC.getStyleValuePixels=getStyleValuePixels;var ASC_nextId=1,flashDiv;function ASC_newId(){return"ASC_ID_"+ASC_nextId++}function ASC_response(response,options){if(void 0===options&&(options={}),"OK"!=response)if("JS:"==response.substr(0,3)){var cmd=""+response.substr(3);try{eval(cmd)}catch(t){var msg=ASC_response_getErrorMsg(cmd,t);options.silent||ASC.ASC_messageBox(msg),options.failure&&options.failure(msg)}}else options.silent||ASC.ASC_messageBox(response)}function ASC_response_getErrorMsg(t,e){function i(t){0<=t&&(s=0<=s?Math.min(s,t):t)}var n="???",s=-1;return i(t.indexOf("\nWarning")),i(t.indexOf("\nFatal error")),i(t.indexOf("\nCatchable fatal error")),s<0&&((n=ASC_getTemporaryErrorMsg(t))?e=n:"Unexpected identifier"==e.message?s=t.lastIndexOf("Error"):i(t.indexOf("Error"))),n=0<=s?e+"\n\n"+t.substr(s,200):""+e}function ASC_getTemporaryErrorMsg(t){var e=t.match(/Error[0-9]+/),i={1569:["8759147973"]};if(e&&e.length){for(var n in i)for(var s=0;s<e.length;s++){var r=e[s].substr(5);if(0<=ASC.indexOf2(i[n],r))return ASC.ls(parseInt(n))+" Error"+r}if(1==e.length)return"index"in e?t.substr(e.index):e[0]}return""}function ASC_action(s,r,o){void 0===o&&(o={});var t=null;"object"!=ASC.type(o)&&(o={modal:!!o}),(o=$j.extend({modal:!0},o)).modal&&(t=new ASC.ui.Dialog({resizable:!1,draggable:!1,width:"180px",title:ASC.ls(2568)+"...",show:!0,dialogClass:"asc-dialog-mask",open:function(t){$j(this).parent().hide(),$j(this).parent().prev(".ui-widget-overlay").attr("style","opacity:0 !important;")}}),setTimeout(function(){t&&(t.$div.parent().fadeIn(),t.$div.parent().prev(".ui-widget-overlay").attr("style",""))},1e3));function a(){t&&(t.$div.parent().fadeOut(),t.$div.dialog("destroy"),t=null)}ASC.isString(r)&&(r+="&_LJSL="+ASC.loadedJSLibs);var n=o.success;delete o.success;var l=o.success2;delete o.success2;var c=$j.ajax($j.extend({url:s,type:"POST",data:r,timeout:6e4,global:!1,success:function(t,e,i){a(),n&&n(),ASC_response(t,{failure:o.failure,silent:o.silent}),l&&l()},error:function(t,e,i){if(a(),o.retry&&0<o.retry){o.retry--;var n=ASC_action(s,r,o);c.ASC_abort=n.ASC_abort}else o.failure?o.failure(t):"gcall"==s?(alert("The operation failed: "+e),logError(6887245346,{status:e,error:i,data:r})):alert("Error connecting to: "+s+"\n"+e)},complete:function(){ASC.remove(ASC.ASC_action_requests,c)}},o));return ASC.ASC_action_requests.push(c),c.ASC_abort=function(){c.abort(),a()},c}function alertMSG(t,e){void 0===e&&(e="Edupage");var i=new ASC.ui.Dialog({width:"1000px",title:e,autoOpen:!1}),n=$j("<div>").css({maxHeight:"500px",overflow:"auto",whiteSpace:"pre"}).html(t);return i.setBody(n),i.center(),i.show(),i}function ASC_messageBox(t){ASC.ui&&ASC.ui.Dialog?new ASC.ui.Dialog({title:"Edupage",width:300,buttons:["OK"]}).setBody(escapeHTML(t).replace(/\n/g,"<br>")):alert(t)}function messageBox(t,e,i){void 0===i&&(i={}),(!i.type||ASC.indexOf(["warning","succes","info","error","customize"],i.type)<0)&&(i.type="succes");var n=$j("<div>").addClass("messageBox "+i.type).appendTo(t).html(e);return i.style&&(n.get(0).style.cssText=i.style),$j("<div>").appendTo(n).addClass("close").click(function(t){n.hide(),i.fn&&"function"==ASC.type(i.fn)&&i.fn(t)}).attr("title",i.fn?ASC.ls(1038):ASC.ls(1567)),n.get(0)}function flashMessage(t,e){void 0===e&&(e={}),flashDiv&&0!=$j(flashDiv).parents("html").length||(flashDiv=ASC.createDiv(document.body,"flash-message-container"));var i=5e3,n=ASC.createSpan(flashDiv),s=ASC.createDiv(n,"flash-message");ASC.createChild(n,"br");var r=$j(e.border_error);if(e.border_error&&(r=findBorderErrorEl(r)).addClass("border_error"),e.auto_column_label){var o=findTextClosest(r,"label");o&&(t=ASC.lsf(1840,{f:o}))}40<t.length&&(i=7e3),80<t.length&&(i=1e4),1<=e.timeout&&(i=e.timeout),s.innerHTML=t,setTimeout(function(){r.length&&r.removeClass("border_error"),n.parentNode&&n.parentNode.removeChild(n)},i)}function findBorderErrorEl(t){if(t.is(":hidden")){var e=t.next(":visible").first();e.length&&!e.is(":hidden")||(e=t.prev(":visible").first()),t=e}return t.is(".asc-autocomplete")&&(t=t.find(".ui-autocomplete-input")),t}function findTextClosest(t,e){var i=t.prevAll(e).first().text();return i=(i=(i=i||t.parent().prevAll(e).first().text())||t.find(e).text())||t.closest(e).text()}ASC.ASC_newId=ASC_newId,ASC.ASC_response=ASC_response,ASC.ASC_response_getErrorMsg=ASC_response_getErrorMsg,ASC.ASC_getTemporaryErrorMsg=ASC_getTemporaryErrorMsg,ASC.ASC_action_requests=[],ASC.ASC_action=ASC_action,ASC.alertMSG=alertMSG,ASC.ASC_messageBox=ASC_messageBox,ASC.messageBox=messageBox,ASC.flashMessage=flashMessage;var Mask=(og.prototype.hide=function(){this.mask.hide(),this.mask=null},og);function og(){var t=this;this.mask=new ASC.ui.Dialog({autoOpen:!1,resizable:!1,draggable:!1,width:"150px",title:ASC.ls(2568)+"...",show:!0,dialogClass:"asc-dialog-mask"}),setTimeout(function(){t.mask&&(t.mask.$div.dialog("open"),$j(".ui-widget-overlay.ui-front").css({opacity:0}))},500)}ASC.Mask=Mask;var PaginatedDiv=(qg.prototype.paginate=function(){return this.stack=[],this.result.pages=[],this.result.map=[],this.maxY=this.$div.offset().top+this.pageHeight+parseFloat(this.$div.css("padding-top")),(this.$div.is('[class*="-landscape"]')||0<this.$div.children().filter('[class*="-landscape"]').length)&&(this.result.format="a4-landscape"),0<this.pageHeight?this.paginateNormal():this.$div.hasClass("print-sheet")?this.result.pages.push(ASC.outerHTML(this.$div.get(0))):this.paginateManual(),this.createHTMLResult(),this.result},qg.prototype.paginateNormal=function(){var t=this.addStackItem(this.$div);this.watermark&&(t.content+=this.nodeHTML(this.watermark.get(0)),t.headers=t.headers.add(this.watermark));try{this.traverse(t)}catch(t){alert(t)}t.needed&&this.emitPage()},qg.prototype.paginateManual=function(){var s=this,t=this.$div.html();this.options.addprintsheet&&(t="<div class='print-sheet'>"+t+"</div>"),this.result.pages.push(t),this.$div.children(".print-sheet-manual").each(function(t,e){s.result.format="custom";var i=$j(e);s.result.height=i.height(),s.result.width=i.width();var n=e.ASC_px2mm;n&&(s.result.px2mm=n)})},qg.prototype.createHTMLResult=function(){var n=this,s="",t="custom"==this.result.format,e=0<this.result.format.indexOf("-landscape");s+='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">\n',s+="<html"+(t?"  mozNoMarginBoxes ":"")+"><head>",s+="<meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>";var r=[];function o(t){return t.sheet||t.styleSheet}$j("LINK").each(function(t,e){if(o(e))if(n.options.css_inline)r.push(e);else{var i=e.getAttribute("href");s+="<link href='"+i+"' type='text/css' rel='stylesheet'/>"}}),$j("STYLE").each(function(t,e){r.push(e)});for(var i=0,a=r;i<a.length;i++){var l=o(a[i]);if(s+="<style type='text/css'>","cssText"in l)s+=l.cssText;else try{var c=l.cssRules;for(var u in c){var d=c[u];d&&d.cssText&&(s+=d.cssText+"\n")}}catch(t){console.warn(t)}s+="</style>"}e&&(s+="<style type='text/css'>@page {size:landscape;}</style>"),t&&(s+="<style type='text/css'>@page {margin: 0px;margin-bottom: -5cm;}</style>"),s+="<title>"+escapeHTML(ASC.school_name)+"</title>",s+="</head>",s+="<body style='margin:0px;padding:0px'><div class='g_echobody' style='margin:0px; padding:0px'>",this.result.html_begin=s,this.result.html_pages=this.result.pages.join(""),this.result.html_end="</div></body></html>",this.result.html=this.result.html_begin+this.result.html_pages+this.result.html_end},qg.prototype.computePageHeight=function(){this.pageHeight=0,this.$div.hasClass("print-sheet")&&(this.pageHeight=parseFloat(this.$div.css("min-height"))-parseFloat(this.$div.css("padding-bottom"))-parseFloat(this.$div.css("padding-top")),(this.pageHeight<400||2e3<this.pageHeight)&&(this.pageHeight=1e3))},qg.prototype.createWatermark=function(){this.watermark=$j("<div>").css({position:"absolute",right:"50px",bottom:"50px",width:"300px",height:"100px",padding:"10px",color:"#000",backgroundColor:"#fff",fontSize:"30px"}).addClass("print-header").text("Unregistered version of Timetables Online")},qg.fixInputValues=function(t){t.find("INPUT").each(function(t,e){e.setAttribute("value",e.value)})},qg.prototype.addStackItem=function(t){var e={el:t,content:"",headers:$j(),needed:!0};return this.stack.push(e),e},qg.prototype.nodeHTML=function(e){try{if(e instanceof HTMLElement||e instanceof SVGElement){var t=ASC.outerHTML(e);return this.options.minify?this.minify(t):t}return"textContent"in e?e.textContent:""+e}catch(t){return e}},qg.prototype.minify=function(t){var e=t.match(this.pattern);if(e)for(var i=0;i<e.length;i++){var n=e[i].match(this.replace),s=ASC.indexOf2(this.result.map,n[1]);s<0&&(s=this.result.map.length,this.result.map.push(n[1])),t=t.replace(n[1],"*"+s)}return t},qg.prototype.emitPage=function(){for(var i=this,t="",e="",n=0,s=this.stack;n<s.length;n++){var r=s[n],o=tagHTML(r.el.get(0));t+=o[0]+r.content,e=o[1]+e,r.needed=!1,r.content="",r.headers.each(function(t,e){r.content+=i.nodeHTML(e)})}this.result.pages.push(t+e)},qg.prototype.getElementType=function(t){if(1!=t.nodeType)return 0;switch(t.tagName.toLowerCase()){case"div":case"table":case"tbody":return(e=$j(t)).is(":hidden")?-1:e.hasClass("print-nobreak")?7:e.hasClass("print-header")?3:e.hasClass("print-pagebreak")?4:e.hasClass("print-nobreakafter")?5:e.hasClass("print-pagebreak-even")?6:e.hasClass("print-breakbefore")?8:0<e.children().length?2:1;case"thead":case"colgroup":case"style":return 3;case"tr":var e;return(e=$j(t)).hasClass("print-header")?3:e.hasClass("print-pagebreak")?4:e.hasClass("print-nobreakafter")?5:e.hasClass("print-breakbefore")?8:1;case"h1":case"h2":case"h3":case"h4":if($j(t).hasClass("print-header"))return 3;break;case"script":return-1}return 1},qg.prototype.traverse=function(t){for(var e=t.el.get(0).firstChild;e;e=e.nextSibling)switch(this.getElementType(e)){case-1:break;case 0:t.content+=this.nodeHTML(e),t.needed=!0;break;case 1:var i=$j(e);this.isItemOverflowed(i)&&this.stack.find(function(t){return t.content})&&(this.emitPage(),this.setMaxY(i)),t.content+=this.nodeHTML(e),t.needed=!0;break;case 7:if(i=$j(e),!this.isItemOverflowed(i)){t.content+=this.nodeHTML(e),t.needed=!0;break}case 8:t.content.trim()&&(this.emitPage(),this.setMaxY($j(e)));case 2:var n=this.addStackItem($j(e));if(this.extraSpace.push(parseFloat(n.el.css("padding-bottom"))+parseFloat(n.el.css("margin-bottom"))+parseFloat(n.el.css("border-bottom-width"))),this.traverse(n),this.extraSpace.pop(),n.needed){var s=ASC.tagHTML(n.el.get(0));t.content+=s[0]+n.content+s[1],t.needed=!0}this.stack.pop();break;case 3:t.content+=this.nodeHTML(e),t.headers=t.headers.add(e),t.needed=!0;break;case 4:this.emitPage(),this.setMaxY($j(e),!0);break;case 5:for(var r=$j(e).offset(),o=this.nodeHTML(e),a=e;a.nextSibling;){var l=a.nextSibling,c=this.getElementType(l);if(5!=c&&2!=c){if(1==c||7==c){a=l,o+=this.nodeHTML(a);break}if(a=e,o=this.nodeHTML(e),"ascpalino"==ASC.edupage)return void alert("Error6257088380");break}a=l,o+=this.nodeHTML(a)}if(this.isItemOverflowed($j(a))){var u=this.getHeaderHeight();this.emitPage(),this.maxY=r.top-u+this.pageHeight}t.content+=o,t.needed=!0,e=a;break;case 6:this.emitPage(),this.result.pages.length%2&&this.emitPage(),this.setMaxY($j(e),!0)}},qg.prototype.isItemOverflowed=function(t){var e=t.outerHeight(!0),i=t.offset();return 0<=e&&i.top+e+this.extraSpace.reduce(function(t,e){return t+e})>this.maxY},qg.prototype.setMaxY=function(t,e){void 0===e&&(e=!1);var i=t.offset(),n=this.getHeaderHeight();this.maxY=i.top+(e?t.outerHeight(!0):0)+this.pageHeight-n},qg.prototype.getHeaderHeight=function(){for(var n=0,t=0,e=this.stack;t<e.length;t++)e[t].headers.filter("DIV,TABLE,TR,THEAD").each(function(t,e){var i=$j(e).outerHeight(!0);0<i&&e.parentNode&&(n+=i)});return n},qg.convertToA3=function(i){var n;$j(".print-sheet",i).each(function(t,e){t%2==0&&(n=$j("<div class='print-sheet A3'>").appendTo(i)),n.append(e)})},qg);function qg(t,e){this.options=e,this.maxY=0,this.extraSpace=[0],this.result={pages:[],format:"a4-portrait",html:"",html_begin:"",html_pages:"",html_end:"",map:[],height:0,width:0,px2mm:0},this.$div=$j(t),"auto"==e.pageHeight?this.computePageHeight():this.pageHeight=e.pageHeight,e.watermark&&this.createWatermark(),e.minify&&(this.pattern=/<[a-zA-Z]+ ([^>]+)>/g,this.replace=/<[a-zA-Z]+ ([^>]+)>/),qg.fixInputValues(this.$div)}function outerHTML(t){if("outerHTML"in t)return t.outerHTML;if(!t.tagName){var e=t.textContent;return void 0===e&&(e=t.data),escapeHTML(e)}if("BR"==t.tagName)return"<BR/>";var i=ASC.tagHTML(t);return i[0]+t.innerHTML+i[1]}function tagHTML(t){var e=t.tagName,i="";return t.className&&(i+=" class="+ASC.escapeAttr(t.className)),t.style.cssText&&(i+=" style="+ASC.escapeAttr(t.style.cssText)),t.rowSpan&&(i+=" rowspan="+ASC.escapeAttr(t.rowSpan)),t.colSpan&&(i+=" colspan="+ASC.escapeAttr(t.colSpan)),t.type&&(i+=" type="+ASC.escapeAttr(t.type)),t.checked&&(i+=" checked="+ASC.escapeAttr(t.checked)),t.src&&"IMG"==t.tagName&&(i+=" src="+ASC.escapeAttr(t.src)),["<"+e+i+">","</"+e+">"]}function escapeAttr(t){return'"'+escapeHTML(t).replace(/"/g,"&quot;")+'"'}function escapeHTML(t){return(t=""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ribbonCombo_fixMenu(t,e){void 0===e&&(e={});for(var i=!1,n=0;n<t.length;n++)if(t[n]&&ASC.isArray(t[n])){i=!0;break}if(i){var s=[],r=[];for(n=0;n<t.length;n++)if(t[n]){var o=t[n];if(ASC.isArray(o))if(0==o.length)0<r.length&&(s.push(r),r=[]);else{s.push(r),r=[];for(var a=0;a<o.length;a++)r.push(o[a])}else r.push(o)}0<r.length&&s.push(r);for(n=t.length=0;n<s.length;n++)t[n]=s[n]}for(n=0;n<t.length;n++){(o=t[n])&&(ASC.isArray(o)?ASC.ribbonCombo_fixMenu(o,e):(o.icon&&!e.mobile&&(o.text="<img src='"+staticUrl(o.icon)+"' style='vertical-align:middle; max-height:16px; margin-top: -5px; margin-bottom: -5px; margin-left: -18px;'/>"+o.text,o.icon=void 0),o.onclick&&"function"==ASC.type(o.onclick)&&(o.onclick={fn:o.onclick}),o.submenu&&(o.submenu.id=ASC.ASC_newId(),ASC.ribbonCombo_fixMenu(o.submenu.itemdata,e))))}}function paginateDiv(t,e,i){return void 0===i&&(i={}),i.pageHeight=e,t&&t.children&&1==t.children.length&&t.children[0].classList.contains("print-sheet")&&(t=t.children[0]),new PaginatedDiv(t,i).paginate()}function printDiv(t,e){if(void 0===e&&(e={}),t.ASC_print)return t.ASC_print();var i=$j(t).hasClass("print-sheet"),n=null;if(!i||!ASC.isIE()||e.preview||confirm(ASC.ls(1899))){e.header&&(n=$j("<h2 class='print-header'>").text(e.header).prependTo(t));var s=ASC.paginateDiv(t,i?"auto":0,{addprintsheet:e.addprintsheet,watermark:e.watermark});n&&n.remove();var r=e.window?e.window:window.open("about:blank","_blank"),o=r.document;if(o.open(),o.write(s.html),o.close(),!e.preview){var a=Math.max(200,20*s.pages.length);ASC.todo_write(function(){r.print()}),$j(r).load(function(){r.setTimeout(function(){ASC.todo_finish()},a)})}}}function getUIParam(t,e,i){var n=t;return(void 0===n||n&&(n.target||n.clientX||n.innerHTML))&&(void 0===(n=e)||n&&(n.target||n.clientX||n.innerHTML))&&(n=i),n}function isVisible(t){var e=$j(t),i=e.is(":visible")&&"hidden"!=e.css("visibility");return i&&0<e.parents(".yui-hidden").length&&(i=!1),e.parents().each(function(t,e){"hidden"==$j(e).css("visibility")&&(i=!1)}),i}function onVisible(t,e){var i=$j(t),n=setInterval(function(){if(isVisible(i))e();else if(0<i.parents("html").length)return;clearInterval(n)},200)}function strVal(t){return void 0===t||!1===t||null===t?"":!0===t?"1":""+t}function boolVal(t){return!!t&&((!ASC.isArray(t)||0!=t.length)&&"0"!=ASC.strVal(t))}function strEmpty(t){return""==strVal(t)}function addActionEnter(t,e,i){$j(t).keydown(function(t){13==t.keyCode&&(t.preventDefault(),e(t,i))})}function deepEquals(t,e){if(t==e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e))return!1;if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)if(!ASC.deepEquals(t[i],e[i]))return!1;return!0}if("object"!=typeof t)return!1;for(var n in t){if(!(n in e))return!1;if(!ASC.deepEquals(t[n],e[n]))return!1}for(var n in e)if(!(n in t))return!1;return!0}ASC.PaginatedDiv=PaginatedDiv,ASC.outerHTML=outerHTML,ASC.tagHTML=tagHTML,ASC.escapeAttr=escapeAttr,ASC.escapeHTML=escapeHTML,ASC.ribbonCombo_fixMenu=ribbonCombo_fixMenu,ASC.paginateDiv=paginateDiv,ASC.printDiv=printDiv,ASC.getUIParam=getUIParam,ASC.isVisible=isVisible,ASC.onVisible=onVisible,ASC.strVal=strVal,ASC.boolVal=boolVal,ASC.strEmpty=strEmpty,ASC.addActionEnter=addActionEnter,ASC.deepEquals=deepEquals;var ASC_ce=(Xi.prototype.subscribe=function(t,e){void 0===e&&(e={}),this.$el.on({ASC_ce:t},e)},Xi.prototype.fire=function(t){this.$el.trigger("ASC_ce",t)},Xi),Compare,vj,wj,xj,tt,Wj,changeEvents,lang_add_nbsp_regex;function Xi(t){this.$el=$j(t)}function Dialog(t,e,s,n){var r;void 0===n&&(n={}),(r=new ASC.ui.Dialog({width:n.width?n.width:"30em",autoOpen:!1,buttons:d,modal:!0})).setHeader(t),r.setBody(e);var i=function(){r.hide()};if("function"==ASC.type(n.okfunc)?i=n.okfunc:n.okfunc&&(i=function(){var t="";for(var e in n.inputs){var i=n.inputs[e];i.id in s&&(i.combo&&i.id+"_combo"in s&&s[i.id+"_combo"]?(t+="&"+i.id+"_combo="+s[i.id+"_combo"],0==s[i.id+"_combo"].indexOf("_not:")&&(t+=s[i.id].value)):t+="&"+i.id+"="+s[i.id].value)}r.hide(),s.ASC_action(n.okfunc,"ok=1"+t)}),n.inputs){var o=document.createElement("div");for(var a in r.$bd.append(o),n.inputs){var l,c=n.inputs[a],u=ASC.createDiv(o,"","display:inline-block;width:150px");ASC.createSpanText(u,c.label),c.type,(l=ASC.createChild(o,"input")).type="text",l.value=c.combo&&c.value in c.combo?"":c.value+"",0==(c.value+"").indexOf("_not:")&&(l.value=c.value.substr(5)),ASC.addActionEnter(l,i),l.id=c.id,s[c.id]=l,c.combo&&function(e,i){function t(t){i.readOnly=!!t&&(t+"").indexOf("_not:")<0,ASC.setClass(i,"sivepozadie",i.readOnly),s[e.id+"_combo"]=t}var n=e.value in e.combo?e.value:0==(e.value+"").indexOf("_not:")?"_not:":"";new ASC.ui.ComboBox(o,n,e.combo,{fn:t}),t(n)}(c,l)}$j("input",o).focus()}var d=[];for(var a in n.buttons||(n.buttons=["ok","close"]),n.buttons){var h=n.buttons[a];if("object"==ASC.type(h))h.handler&&!h.onclick&&(h.onclick=h.handler),d.push(h);else switch(h){case"close":d.push(ASC.ls(1567));break;case"cancel":d.push(ASC.ls(1038));break;case"ok":d.push({text:ASC.ls(1573),onclick:i,type:"default"})}}return r.setButtons(d),r.show(),r}function zj(t,e,i){return(t=Aj(t))<(e=Aj(e))?i?1:-1:e<t?i?-1:1:0}function Aj(t){return null==t?t="":t.constructor==String?isNaN(t)?t=t.toLowerCase():""!=t&&(t*=1):t.constructor==Boolean&&(t=""+t),t}function Cj(t,e,i){if(ASC.isArray(t))return Cj(t[0],e,i);if(ASC.isArray(e))return Cj(t,e[0],i);if(null===xj&&(xj=ASC.school_country||"en",wj=ASC.lang_getLocale()),"en"!=xj&&t&&t.constructor==String&&e&&e.constructor==String){if(t==e)return 0;var n={numeric:!1};if(isNaN(t)&&isNaN(e))return i?e.localeCompare(t,wj,n):t.localeCompare(e,wj,n)}return zj(t,e,i)}function getSessionStorage(e,t){void 0===t&&(t="array");var i=null;if(sessionStorage&&(i=sessionStorage.getItem(e))){try{i=JSON.parse(i)}catch(t){sessionStorage.setItem(e,""),ASC.logError(9174973301,i),i=!1}ASC.type(i)!=t&&(sessionStorage.setItem(e,""),ASC.logError(9174973302,i),i=!1)}return i}function subscribeToggleBox(t,e,i){void 0===i&&(i={});var n=$j(e);$j(t).addClass("toggleBox"+(i.active?" active":"")).click(function(){n.toggle(i.easing||"slide"),$j(this).toggleClass("active")}),i.active||n.hide()}function scaleDown(t){var e=t.scrollHeight,i=t.clientHeight,n=i/e;if(n<1){var s=(i-e)/2;$j(t).css("transform","scale("+n+", "+n+") translateY("+s+"px)"),ASC.ascdebug&&console.log("transform","scale("+n+", "+n+") translateY("+s+"px)")}}function lang_add_nbsp(t){return lang_add_nbsp_regex=lang_add_nbsp_regex||/\b(0.|1.|2.|3.|4.|5.|6.|7.|8.|9.|a|i|bez|bezo|cez|cezo|do|k|ku|medzi|mimo|na|nad|o|od|odo|po|pod|popod|popri|pre|pri|s|so|u|v|vo|z|za|zo|mgr.|rndr.|prof.|doc.|ing.|phdr.|ÄŤ.|veÄľmi| Â§|Ä…|des|du|de|Ĺ•|z.|y|la|en|der|die|das|nr.|dipl.|â€ždipl.|the|on|Ă˘|Ĺ„|Ă®) /gi,t.replace(lang_add_nbsp_regex,"$1Â ")}function ucfirst(t){return t?t.substr(0,1).toUpperCase()+t.substr(1):""}function getHelpUrl(t,e){return"edupage"==e?"http://help.edupage.org/text.php?id="+t+"&lang="+ASC.lang:"tt"==e?"http://help.asctimetables.com/text.php?id="+t+"&lang="+ASC.lang:"agenda"==e?"http://pomoc.skoly.org/text.php?lang=sk&id="+t:"http://help.asctimetables.com/text.php?id="+t+"&lang="+ASC.lang}function unmountReactChildren(t){if(t._reactRootContainer)ASC.require("react-dom").unmountComponentAtNode(t);else for(var e=t.firstElementChild;e;e=e.nextElementSibling)e instanceof HTMLElement&&ASC.unmountReactChildren(e)}ASC.ASC_ce=ASC_ce,ASC.Dialog=Dialog,vj=Compare=ASC.Compare||(ASC.Compare={}),wj=null,xj=null,vj.compareBase=function(t,e,i){return null==t||!1===t?null==e||!1===e?0:i?1:-1:null===e||null==e||!1===e?i?-1:1:null},vj.compareSimple=zj,vj.compareCombo=function(t,e,i,n){if(!n||!n.length)return Cj(t,e,i);var s=1e6,r=1e6;t=ASC.strVal(t),e=ASC.strVal(e);for(var o=n.length-1;0<=o;o--){var a=ASC.strVal(n[o].value);t==a&&(s=o),e==a&&(r=o)}return zj(s,r,i)},vj.compare=Cj,Wj=tt=ASC.tt||(ASC.tt={}),Wj.addEs=function(t){return"s"==t.substring(t.length-1)?t+"es":t+"s"},Wj.removeEs=function(t){return"types"==t.substring(t.length-5)?t.substring(0,t.length-1):"es"==t.substring(t.length-2)?t.substring(0,t.length-2):t.substring(0,t.length-1)},Wj.StudentPresenceState=function(t,e){void 0===e&&(e="");var i=0;switch(e){case"P":i=1;break;case"A":i=2;break;case"L":i=3;break;case"E":i=4;break;default:i=ASC.presence_P?0:1}var n=-16*i+"px 0px";if(t.style&&""!=t.style.backgroundPosition)t.style.backgroundPosition=n;else{var s=ASC.createDiv(t,"sspicker-state");1<e.indexOf("px")?s.style.backgroundPosition=e:s.style.backgroundPosition=n}},function(_){function r(t,e){t=$j(t)[0];for(var i=0;i<_.handlers.length;i++){var n=_.handlers[i];n.$div[0]==t&&(e&&n.key!=e||_.handlers.splice(i,1))}}_.on=function(t,e,i,n,s){new a(e,t,i,n,s)},_.off=r;var t=!(_.handlers=[]),$=null;function S(){return ASC.currentTimeMillis()/1e3}function o(){t||(t=!0,$j(window).on("blur focus mousemove touchstart touchend keydown",function(){_.user_alive_time=S()}),_.my_id="t"+Math.round(999e6*Math.random()),_.my_ls_key="changeEvents_"+_.my_id,x(),window.localStorage&&window.addEventListener("storage",function(t){if(t.key&&"changeEvents"==t.key.substr(0,12)){var e=JSON.parse(t.newValue);if(!e||!e.time||!e.my_id)return;if(5<S()-e.time)return;e.my_keys&&e.my_next_time&&e.my_gpids&&(_.others[e.my_id]={time:e.time,my_keys:e.my_keys,my_next_time:e.my_next_time,my_gpids:e.my_gpids}),e.data&&A(e.data)}}))}function w(){var i=[];return $j(".asc-gadget-jsc").each(function(t,e){e.ASC_gjsc&&e.ASC_gjsc.ASC_gpid&&i.push(e.ASC_gjsc.ASC_gpid)}),i}function x(){setTimeout(x,800+400*Math.random());for(var t=S(),e=_.handlers.length-1;0<=e;e--)_.handlers[e].valid()||_.handlers.splice(e,1);for(var i=0,n=_.handlers;i<n.length;i++){(d=n[i]).maybecall()}if(0!=_.handlers.length){for(var s=0,r=0,o=_.handlers;r<o.length;r++){var a=(d=o[r]).next_time();a&&(s=s?Math.min(s,a):a)}if(s&&s<t&&!$){for(var l=[],c=0,u=_.handlers;c<u.length;c++){var d=u[c];l.indexOf(d.key)<0&&l.push(d.key)}var h=w();for(var p in _.others){var f=_.others[p];if(5<t-f.time)delete _.others[p];else{for(var v=0,g=f.my_keys;v<g.length;v++){var m=g[v];l.indexOf(m)<0&&l.push(m)}$j.merge(h,f.my_gpids)}}($=$j.ajax("/gcall?gaction=pollChangeEvents",{type:"POST",data:{keys:l.join(","),gpids:h.join(",")},success:function(t){t&&t.ce_data&&(A(t.ce_data),k(t.ce_data))},complete:function(){$=null},error:function(t,e,i){console.log([t,e,i])}})).isErrorHandled=!0}else{for(var b=[],y=0,C=_.handlers;y<C.length;y++){d=C[y];b.indexOf(d.key)<0&&b.push(d.key)}window.localStorage&&(window.localStorage.setItem(_.my_ls_key,JSON.stringify({time:S(),my_id:_.my_id,my_next_time:s,my_keys:b,my_gpids:w()})),window.localStorage.removeItem(_.my_ls_key))}}}function A(t){for(var e in t){var i=t[e];if(i)for(var n=0,s=_.handlers;n<s.length;n++){var r=s[n];r.key==e&&r.received(i)}}}function k(t,e){window.localStorage&&(e=e||ASC.currentTimeMillis()/1e3,window.localStorage.setItem(_.my_ls_key,JSON.stringify({time:e,my_id:_.my_id,data:t})),window.localStorage.removeItem(_.my_ls_key))}_.user_alive_time=S(),_.others={},_.post=function(t,e,i){void 0===i&&(i=null);var n={};n[t]=e,A(n),k(n)};var a=(e.prototype.next_time=function(){var t=this.prefInterval;return S()-_.user_alive_time<600||(t=Math.max(t,this.maxInterval)),this.last_time+t},e.prototype.received=function(t,e){var i=this;if(void 0===e&&(e=null),!this.last||t<=this.last||t>this.last+100)return this.last=t,this.last_payload=null,void(this.last_time=S());this.last=t,this.last_payload=e,this.last_time=S(),this.dirty=!0,setTimeout(function(){i.maybecall()},0)},e.prototype.valid=function(){return 0<this.$div.parents("html").length},e.prototype.maybecall=function(){if(this.dirty){this.dirty=!1;try{this.callback(this.key,this.last_payload)}catch(t){console.log(t)}}},e);function e(t,e,i,n,s){void 0===s&&(s={}),this.callback=null,this.last=null,this.last_payload=null,this.last_time=0,this.prefInterval=5,this.maxInterval=60,this.dirty=!1,this.key=t,this.$div=$j(e),this.callback=i,this.last_time=S(),r(e,t),n&&(this.last=n),s.prefInterval&&(this.prefInterval=s.prefInterval),s.maxInterval&&(this.prefInterval=s.maxInterval),s.payload&&(this.payload=!0),_.handlers.push(this),o()}_.Handler=a}(changeEvents=ASC.changeEvents||(ASC.changeEvents={})),ASC.getSessionStorage=getSessionStorage,ASC.subscribeToggleBox=subscribeToggleBox,ASC.scaleDown=scaleDown,ASC.lang_add_nbsp=lang_add_nbsp,ASC.ucfirst=ucfirst,ASC.getHelpUrl=getHelpUrl,ASC.unmountReactChildren=unmountReactChildren}(ASC=ASC||{});var __awaiter=this&&this.__awaiter||function(t,o,a,l){return new(a=a||Promise)(function(e,i){function n(t){try{r(l.next(t))}catch(t){i(t)}}function s(t){try{r(l.throw(t))}catch(t){i(t)}}function r(t){t.done?e(t.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(t.value).then(n,s)}r((l=l.apply(t,o||[])).next())})},__generator=this&&this.__generator||function(i,n){var s,r,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,r&&(o=2&e[0]?r.return:e[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,e[1])).done)return o;switch(r=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,r=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],r=0}finally{s=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),s=0;for(e=0;e<i;e++)for(var r=arguments[e],o=0,a=r.length;o<a;o++,s++)n[s]=r[o];return n};!function(l){var o=(c.prototype.required=function(){this.loaded||void 0===this.exports&&(this.exports={},this.sourceFunc(this.exports,this.require,this),this.loaded=!0)},c.prototype.fetchSource=function(a){var t=this;return null!==this.sourceFunc?Promise.resolve():(this.fetch_promise||(this.fetch_promise=__awaiter(t,void 0,void 0,function(){var e,i,n,s,r,o=this;return __generator(this,function(t){switch(t.label){case 0:return this.sourceFunc?[3,2]:[4,new Promise(function(i,n){var s=new XMLHttpRequest,t=o.url,e=t.toLowerCase();window&&window.ascSrcVer&&window.ascSrcVer[e]&&(t=t+"?"+window.ascSrcVer[e]),s.open("GET",t),s.onload=function(){return __awaiter(o,void 0,void 0,function(){var e;return __generator(this,function(t){(e=s.responseText)||l.dieError("5280005232",this.url);try{0<=this.url.indexOf("react-dom.development")&&(e=e.replace("var ReactDOM = {","var ReactDOM = {requestCurrentTime:requestCurrentTime,scheduleWork:scheduleWork,")),this.source=e,this.sourceFunc=new Function("exports","require","module",e+"\n//@ sourceURL="+this.url),i()}catch(t){n(t)}return[2]})})},s.onerror=function(t){n(new Error(""+t))},s.send()})];case 1:t.sent(),t.label=2;case 2:if(a=__spreadArrays(a,[this]),e=[],i=!0,this.node_module&&(n={"react-dom":["react"],"@tensorflow/tfjs":[]}[this.node_module])&&(e=__spreadArrays(n),i=!1),i){for(s=/(return|=>|)\s{0,3}\brequire\(['"]([^'"]+)['"]\)/g,r=void 0;null!==(r=s.exec(this.source));)"return"!=r[1]&&"=>"!=r[1]&&"tslib"!=r[2]&&e.push(r[2]);for(s=/importLegacyJsLib\(['"]([^'"]+)['"]\)/g;null!==(r=s.exec(this.source));)e.push("legacyjs:"+r[1]);for(s=/importCss\(['"]([^'"]+)['"]\)/g;null!==(r=s.exec(this.source));)e.push("css:"+r[1])}return[4,Promise.all(e.map(function(t){return"legacyjs:"==t.substr(0,"legacyjs:".length)?o.fetchLegacyJsLib(t.substr("legacyjs:".length)):"css:"==t.substr(0,"css:".length)?o.fetchCssLib(t.substr("css:".length)):u(c.resolveUrl(t,o),a)}))];case 3:return t.sent(),[2]}})})),this.fetch_promise)},c.prototype.fetchLegacyJsLib=function(n){return new Promise(function(t,e){var i=n.toLowerCase();window&&window.ascSrcVer&&window.ascSrcVer[i]&&(n=n+"?"+window.ascSrcVer[i]),barJsLibraryLoad(n,function(){t()})})},c.prototype.fetchCssLib=function(n){return new Promise(function(t,e){var i=n.toLowerCase();window&&window.ascSrcVer&&window.ascSrcVer[i]&&(n=n+"?"+window.ascSrcVer[i]),barCssLoad(n),t()})},c.prototype.implementRpc=function(t){for(var e=this,i=function(o){n.exports[o]=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return __awaiter(e,void 0,void 0,function(){var n,s=this;return __generator(this,function(t){switch(t.label){case 0:return[4,l.requireAsync("/asc/edurequest")];case 1:return n=t.sent().EduRequest_Client,[2,new Promise(function(t,e){var i=new XMLHttpRequest;i.open("POST",s.url+"?__func="+o),i.setRequestHeader("Content-type","application/json; charset=utf-8"),i.onload=function(){try{t(function(t){var e;try{e=JSON.parse(t)}catch(n){var i=/Error([0-9]{1,16})/g.exec(""+t);throw i&&i[1]?new Error("RPC Error"+i[1]):n}if(e.e){if(e.en&&e.em){var n=new Error(e.en);throw n.errNumber=e.en,n.msg=e.em,n}throw e.e}return e.ce&&setTimeout(function(){for(var t in e.ce)l.changeEvents.post(t,e.ce[t],e.cep&&e.cep[t])},0),e.r}(i.responseText))}catch(t){e(t)}},i.onerror=function(t){e(new Error(""+t))},i.send(JSON.stringify({__args:r.map(function(t){return t instanceof n?null:t}),__gsh:l.gsechash}))})]}})})}},n=this,s=0,r=t;s<r.length;s++)i(r[s])},c.resolveUrl=function(t,e){var i=t.replace("\\","/");"."==i[0]&&(i=e.url.substr(0,e.url.lastIndexOf("/")+1)+i),i=i.replace(/\/\.\//g,"/");for(var n=0;n<10&&!(i.indexOf("..")<0);n++)i=i.replace(/\/[^\/]+\/\.\.\//g,"/");if("/"!=i[0]){if(0<=["crypto","@tensorflow/tfjs-node","@tensorflow/tfjs-node-gpu"].indexOf(t))throw new Error("Module not supported on client: "+t);i="/node_modules/"+i,!l.ascdevelop&&!l.ascdebug||d()||(i+=".development"),i+=".js"}else".js"!=i.substr(-3)&&(i+=".js");return i},c);function c(t){var i=this;this.url=t,this.node_module="",this.exports=void 0,this.require=null,this.loaded=!1,this.sourceFunc=null,this.source=null,this.fetch_promise=null,l._modules[t]=this;var e=t.indexOf("/node_modules/");0<=e&&(this.node_module=t.substring(e+14,Math.min(t.indexOf(".development"),t.length-4))),this.require=function(t){if("tslib"==t)return s;var e=c.resolveUrl(t,i);return l.require(e)}}function u(i,n){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,function(){return __awaiter(this,void 0,void 0,function(){var e,i,n,s,r;return __generator(this,function(t){switch(t.label){case 0:for(n in e=d(),i=[],a)i.push(n);s=0,t.label=1;case 1:return s<i.length?(r=i[s],[4,a[r]]):[3,4];case 2:t.sent(),t.label=3;case 3:return s++,[3,1];case 4:if(e==d())return[3,6];t.label=5;case 5:return[3,0];case 6:return[2]}})})}()];case 1:return t.sent(),[4,(e=(e=l._modules[i])||new o(i)).fetchSource(n)];case 2:return t.sent(),[2,e]}})})}l.setModuleSourceFunc=function(t,e){var i=l._modules[t];null===(i=i||new o(t)).sourceFunc&&(i.sourceFunc=e,i.source=e.toString())},l.require=function(t,e){void 0===e&&(e=!1);var i=(t=function(t){if("."!=t[0])return t;var e=t.lastIndexOf("..");return e<0&&l.dieError("2599963543"),t.substr(e+2)}(t)).indexOf("#");if(0<=i){var n=t.substr(i+1),s=l.require(t.substr(0,i),e);return"function"==typeof s.then?s.then(function(t){return t[n]}):s[n]}t=o.resolveUrl(t,null);var r=l._modules[t];return r&&r.sourceFunc&&!e?(r.required(),r.exports):(e||console.log("Module: "+t+" is not loaded - returning Promise"),u(t,[]).then(function(t){return t.loaded||t.required(),t.exports}))},l._modules={},l.requireAsync=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,l.require(e,!0)]})})},l.fetchModuleAsync=u;var a={};function d(){return l.count(a)}l.bundle_v="",l.loadBundle=function(t){if(!a[t]){var e=!l.ascdebug;a[t]=n("/global/pics/js/bundles/bundle_"+t+(e?".min.js":".js")+"?v="+l.bundle_v)}return a[t]};var i={};function n(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return i[e]||(i[e]=new Promise(function(t){barJsLibraryLoad(e,t)})),[2,i[e]]})})}l.loadJsLib=n,l.blockUI=function(s){return __awaiter(this,void 0,void 0,function(){var e,i,n;return __generator(this,function(t){switch(t.label){case 0:e=$j("<div class='loadingDiv loading-background' style='display:block;z-index:1000'/>").appendTo(document.body),i=null,t.label=1;case 1:return t.trys.push([1,3,4,5]),"function"==typeof s&&(s=s()),[4,s];case 2:return i=t.sent(),[3,5];case 3:return n=t.sent(),l.showError(n),[3,5];case 4:return e.remove(),[7];case 5:return[2,i]}})})},l.isBlockedUI=function(){return 0<document.getElementsByClassName("loadingDiv").length};var s,t,r,h=null,p=0;function f(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,s,r=i.call(t),o=[];try{for(;(void 0===e||0<e--)&&!(n=r.next()).done;)o.push(n.value)}catch(t){s={error:t}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(s)throw s.error}}return o}l.showError=function(t){if(!(t==h&&p+2e3>Date.now())){h=t,p=Date.now(),console.error(t);var e="";t instanceof Error&&(e=t.message+"\n\n("+t.name+")",t.errNumber&&t.msg&&(e=t.msg+"\n\n(Error"+t.errNumber+")")),e=(e=e||""+t)||"Unknown error",l.ASC_messageBox(e)}},t=s=s||{},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},t.__extends=function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},t.__assign=function(){return t.__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var s in e=arguments[i])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},t.__assign.apply(this,arguments)},t.__rest=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&(i[n[s]]=t[n[s]])}return i},t.__awaiter=function(r,o,a,l){return new(a=a||Promise)(function(t,e){function i(t){try{s(l.next(t))}catch(t){e(t)}}function n(t){try{s(l.throw(t))}catch(t){e(t)}}function s(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}s((l=l.apply(r,o||[])).next())})},t.__generator=function(i,n){var s,r,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,r&&(o=2&e[0]?r.return:e[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,e[1])).done)return o;switch(r=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,r=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],r=0}finally{s=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},t.__values=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}},t.__read=f,t.__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(f(arguments[e]));return t},t.__spreadArrays=function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),s=0;for(e=0;e<i;e++)for(var r=arguments[e],o=0,a=r.length;o<a;o++,s++)n[s]=r[o];return n},t.__await=function t(e){return this instanceof t?(this.v=e,this):new t(e)},t.__importDefault=function(t){return t&&t.__esModule?t:{default:t}}}(ASC=ASC||{}),window.require=function(t){return ASC.require(t)};var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(Ft){var Et;!function(t){function r(t,e,i,n){void 0===e&&(e=75),void 0===i&&(i="\n"),void 0===n&&(n=0);var s,r,o,a,l,c=e,u=i,d=n;if(t+="",c<1)return t;for(s=-1,o=(l=t.split(/\r\n|\n|\r/)).length;++s<o;l[s]+=a)for(a=l[s],l[s]="";a.length>c;l[s]+=a.slice(0,r)+((a=a.slice(r)).length?u:""))r=2==d||(r=a.slice(0,c+1).match(/\S*(\s)?$/))[1]?c:r.input.length-r[0].length||1==d&&c||r.input.length+(r=a.slice(c).match(/^\S*/))[0].length;return l.join("\n")}function u(t,e,i){void 0===i&&(i=!1);var n="";return e.icon&&(n="<img src='"+staticUrl(e.icon)+"' height='16px'/> "),n+=i?t:Ft.escapeHTML(t),e.iconRight&&(n+=" <img src='"+staticUrl(e.iconRight)+"' height='16px'/> "),n}t.getFocusedDialog=function(){var t=$j("div.ui-dialog,div.yui-dialog");return 0!=t.length?t.last().get(0):null},t.autocomplete_data2items=function(t){for(var e=[],i=0;i<t.length;i++){var n=Ft.clone(t[i]),s=""+n.name;n.code&&(s+=" "+n.code),n.code2&&(s+=" "+n.code2),n.label=s,e.push(n)}return e},t.autocomplete_renderItem=function(t,e){var i=$j("<li class='ui-menu-item' role='presentation'>"),n=$j("<a class='ui-corner-all' tabindex='-1'>").appendTo(i);if(n.text(e.name),e.subname&&$j("<span style='font-size:85%; color:#888; margin-left:5px'>").text(e.subname).appendTo(n),e.code||e.code2){var s=$j("<span style='display: block; font-size:85%; color:#888'>").appendTo(n);e.code&&s.text(e.code),e.code2&&$j("<span style='float:right'>").prependTo(s).text(e.code2)}return i.appendTo(t),i},t.addAutoComplete=function(t,e,i){void 0===i&&(i={}),$j.widget("ui.autocomplete",$j.ui.autocomplete,{_renderItem:function(t,e){return $j("<li>").append("<a>"+e.label+"</a>").appendTo(t)}});var n=[];if("object"==Ft.type(e))for(var s in e)n.push({value:e[s],label:s});return $j(t).autocomplete($j.extend({minLength:0,autoFocus:!0,source:n.length?n:e},i))},t.autocapitalize=function(t){["sk","cz","de","at"].indexOf(Ft.school_country)<0||$j(t).on("DOMAttrModified textInput input keypress paste focus",function(){var t=$j(this).val();if(!(t.length<1)){var e=t.charCodeAt(0);if(!(55296<=e&&e<=56319)){var i=t.slice(0,1).toUpperCase()+t.slice(1);i!=t&&$j(this).val(i)}}})},t.getTextWithIcon=u;var e=(a.prototype.setButtons=function(t){var e=this;void 0===t&&(t=[]);for(var i=this.$ft.find(".ui-dialog-buttonset").detach().html(""),n=0,s=t;n<s.length;n++){var r=s[n];Ft.isArray(r)&&0==r.length?i.append("<span style='display:inline-block; width:15px'>"):(Ft.isString(r)&&(r={text:r,onclick:function(){e.hide()},type:"ok"==r.toLowerCase()?"default":""}),$j.extend(r,{container:i,label:r.text}),r.onclick&&("function"==typeof r.onclick?r.onclick={fn:r.onclick,scope:this}:r.onclick.scope=this),new o(r))}i.appendTo(this.$ft)},a.prototype.setBody=function(t){this.$bd.html(""),this.$bd.append(t)},a.prototype.appendToFooter=function(t){this.$ft.append(t)},a.prototype.center=function(){this.$div.dialog("option","position",{my:"center",at:"center",of:window});var t=this.$div.dialog("option","maxWidth");this.$div.dialog("option","width")>t&&this.$div.dialog("option","width",t),this.$div.dialog("widget").draggable("option","containment","none"),$j(window).resize()},a.prototype.setHeader=function(t){this.$div.dialog("option","title",t)},a.prototype.show=function(){this.$div.dialog("open")},a.prototype.isVisible=function(){return this.$div.is(":visible")},a.prototype.hide=function(){this.$div.is(":visible")&&this.$div.dialog("close")},a.prototype.setMaximizeBtn=function(t){function e(){"function"==Ft.type(t)?t():a.makeFitHeight(t),n=!0}var i=this,n=!1,s=this.setHeaderBtn("maximize","ui-icon-arrowthick-2-ne-sw",function(){n||e(),i.toggleMaximize()});window.setTimeout(function(){i.$div.outerWidth()>document.body.clientWidth?(console.log("out of view - maximizing"),s.click()):(i.$div.outerHeight()>document.body.clientHeight||i.$div.data("origSize"))&&e()},200)},a.prototype.setMaximizeTabElements=function(r,o){this.setMaximizeBtn(function(){for(var t=r.$labels.find(".selected").index(),e=0;e<r.tabs.length;e++)r.selectTab(e);r.selectTab(t);for(var i=0,n=o;i<n.length;i++){var s=n[i];s instanceof Ft.ui.dt.DataTable&&(s=s.$container),$j(s).addClass("fitHeight"),a.makeFitHeight(s)}})},a.prototype.toggleMaximize=function(){var t={width:0,height:0},e=this.$div.data("origSize")||{};if(!e.width){var i=$j(window);t.width=this.$div.dialog("option","width"),t.height=this.$div.dialog("option","height"),e.width=i.width()-10,e.height=i.innerHeight()-10}this.$div.dialog("option","width",e.width),this.$div.dialog("option","height",e.height),this.$div.data("origSize",t),this.$div.trigger("dialogresize"),this.$div.trigger("resize"),this.center()},a.prototype.setPinBtn=function(e){var i=this,n=this.setHeaderBtn("toggle pin","ui-icon-pin-w",function(){if(n.find(".ui-icon-pin-w").length){var t=$j(".ui-icon-pin-s");i.$div.dialog("option","position",{my:e,at:e,of:window,within:t.length?t.last():window,collision:"fit none"})}else i.center();n.find(".ui-icon-pin-w, .ui-icon-pin-s").toggleClass("ui-icon-pin-w ui-icon-pin-s")});if(!this.$div.dialog("option","modal")){var s=function(t){i.$div&&i.$div.parent().length?$j.contains(i.$div.parent().get(0),t.target)||$j(t.target).is(".ui-widget-overlay.ui-front")||!n.find(".ui-icon-pin-w").length||i.hide():$j(document.body).off("click",s)};$j(document.body).click(s)}},a.prototype.setHeaderBtn=function(t,e,i){var n=this.$div.dialog("widget").find(".ui-dialog-titlebar ."+e);n.length&&n.remove();var s=this.getTitleBar().find(".ui-dialog-titlebar-close").last();return(n=s.clone().insertBefore(s).attr("title",t).css(Ft.rtl("right","left"),"2em")).find(".ui-icon-closethick").removeClass("ui-icon-closethick").addClass(e),n.find(".ui-button-text").text(t),n.click(i).hover(function(){$j(this).toggleClass("ui-state-hover")}),n},a.prototype.getTitleBar=function(){return this.$div.dialog("widget").find(".ui-dialog-titlebar")},a.prototype.setTitleBarIconBtn=function(t,e){return $j("<button class='ui-button ui-button-icon-only'>").append("<span class='ui-button-icon-primary ui-icon "+t+"'>").css({width:"21px",border:"none",margin:"-3px 0 0",background:"transparent"}).appendTo(this.getTitleBar().find(".ui-dialog-title")).hover(function(){$j(this).toggleClass("ui-state-hover")}).click(e)},a.makeFitHeight=function(t){Ft.ui.dt&&t instanceof Ft.ui.dt.DataTable&&(t=t.$container);var e=$j(t),i=e.parents(".ui-dialog-content");if(0!=i.length){var n=i.dialog("option","height");for(n&&"auto"!=n||i.dialog("option","height",i.parent().height());0!=e.length&&!e.hasClass("ui-dialog-content");){var s=e.parent(),r=s.children(":visible");"block"==s.css("display")&&1<r.length&&s.css({display:"flex","flex-direction":"column"}),"flex"==s.css("display")&&"column"==s.css("flex-direction")?e.css({flex:"1 1 100px",height:"100px"}):e.css("height","100%"),e=s}}},a.areYouSureDlg=function(n){return new Promise(function(t){var e=new Ft.ui.Dialog({title:"Edupage"}),i=!1;e.setButtons([{text:Ft.ls(1573),type:"default",onclick:function(){i=!0,e.hide()}},Ft.ls(1038)]),e.setBody(Ft.escapeHTML(n).replace(/\n/g,"<br>")+" - "+Ft.ls(1054)),e.$div.on("dialogclose",function(){t(i)})})},a);function a(t){var i=this,e=$j.extend({modal:!0,minHeight:50,maxWidth:$j(window).innerWidth(),width:"auto",destroyOnClose:!0},t);e.buttons=[{}],this.$div=$j("<div style='overflow:visible'>").dialog(e),(this.$div.get(0).ASC_dlg=this).$div.parent().css("overflow","visible"),e.destroyOnClose&&this.$div.on("dialogclose",function(){i.dlg_jsc&&i.dlg_jsc.ASC_cn(),i.$div.dialog("destroy"),i.$div.detach()}),this.$bd=$j("<div>").appendTo(this.$div),this.$ft=this.$div.siblings(".ui-dialog-buttonpane"),this.body=this.$bd.get(0),this.footer=this.$ft.get(0),this.cfg={queueProperty:function(t,e){switch(t){case"width":i.$div.dialog("option","width",parseInt(e));break;case"buttons":i.setButtons(e);break;case"maximizeEl":i.setMaximizeBtn(e);break;case"maximizeTabElements":i.setMaximizeTabElements(e[0],e.slice(1))}}},this.cfg.queueProperty("buttons",t.buttons),t.pin&&this.setPinBtn(t.pin)}t.Dialog=e;var o=(i.prototype.createMenu=function(t){var e=this.$element.parents(".ui-dialog");this.menu=new wt(t,{container:e.length?e.get(0):document.body})},i.prototype.label=function(t){this.label_html(Ft.escapeHTML(t))},i.prototype.label_html=function(t){this.$element.html(t)},i.prototype.set=function(t,e){switch(t){case"disabled":this.$element.attr("disabled",e).toggleClass("button-disabled",e)}},i);function i(e){var i=this;this.onclick=null,this.radio_field=null,this.radio_value="";var t=$j('<div class="asc-button-container">').appendTo(e.container);this.$element=$j("<button class='asc-button'>").appendTo(t);var n="button-gray";if("default"==e.type?n="button-green":e.type&&(n="button-"+e.type),e.cssClass&&(n=e.cssClass),e.disabled&&(n+=" button-disabled"),this.$element.addClass(n),e.disabled&&this.$element.attr("disabled","disabled"),e.style&&(this.$element.get(0).style.cssText=e.style),e.onclick&&("function"==typeof e.onclick?this.onclick={fn:e.onclick}:this.onclick=e.onclick),e.menu&&this.$element.addClass("menu"),e.title&&t.attr("title",e.title),this.label_html(u(e.label,e,!0)),this.$element.click(function(t){t.preventDefault(),t.stopPropagation(),e.menu&&(i.menu||i.createMenu(e.menu),$j(document).click(),i.menu.show(i.$element)),i.onclick&&i.onclick.fn.call(i.onclick.scope||i,t,i.onclick.obj),i.radio_field&&(i.radio_field.val(i.radio_value),i.radio_field.trigger("change"))}).mousedown(function(t){t.preventDefault(),document.activeElement.blur()}),e.radio_field){this.radio_field=$j(e.radio_field),this.radio_value=Ft.strVal(e.radio_value);var s=function(){i.$element.toggleClass("selected",i.radio_field.val()==i.radio_value)};this.radio_field.change(s),s()}}t.Button=o;var s=(n.prototype.check=function(t){return void 0===t&&(t=!this.$input.prop("checked")),this.$input.prop("checked",t),this.button.$element.toggleClass("button-blue",t).toggleClass("button-gray",!t),t},n);function n(t,e,i){var n=this;this.$input=$j('<input type="checkbox">').appendTo(t).hide(),this.button=new o({container:t,label:e,onclick:function(t){var e=n.check();i.onclick&&(i.onclick.fn?i.onclick.fn(t,e,i.onclick.obj):i.onclick(t,e))}}),i.checked&&this.check()}t.CheckboxButton=s;var l=(c.prototype.setValue=function(t){var e,i;e=t&&"0"!=t?(i=!this.options.inverted,"1"):(i=this.options.inverted,"0"),this.input.checked=i,this.input.value=e},c.prototype.updateValue=function(){this.input.value=!this.input.checked==!this.options.inverted?"0":"1"},c);function c(t,e,i,n){var s=this;void 0===n&&(n={}),this.options=n;var r=this.$input=$j("<input type='checkbox'>").appendTo(t),o=this.input=r.get(0);(o.ASC_cb=this).options=$j.extend({inverted:!1,readonly:!1},n),this.options.readonly&&r.attr("disabled",1),this.setValue(e);var a,l=o.checked;r.click(function(){s.options.readonly?o.checked=l:(s.updateValue(),r.trigger("ASC_ce"))}),o.ASC_ce=new Ft.ASC_ce(r),this.ASC_ce=o.ASC_ce,n.slider&&(a=$j('<label class="checkbox-slider"><span class="checkbox-slider-body"><span class="checkbox-slider-switch"/><span class="checkbox-slider-track"><span class="checkbox-slider-bgd"/><span class="checkbox-slider-bgd checkbox-slider-bgd-negative"/></span></span></label>').appendTo(t).prepend(r).toggleClass("slider-small",!!n.small),"green"==n.cssClass&&a.find(".checkbox-slider-bgd").first().addClass("green")),n.cssClass&&r.addClass(n.cssClass);var c=null;i&&(Ft.isString(i)?(c=$j("<span>").text(i).appendTo(a||t).css("cursor","pointer").click(function(t){r.click(),t.preventDefault()}),this.options.style&&(c[0].style.cssText+=";"+this.options.style),this.options.html&&(console.log(this.options),c.prepend(this.options.html))):c=$j(i).css("cursor","pointer").click(function(t){r.click(),t.preventDefault()})),n.title&&c&&c.attr("title",n.title),n.fn&&this.ASC_ce.subscribe(function(){n.fn(s.input.value)})}t.Checkbox=l;var d=(h.prototype.val=function(){return this.$div.slider("value")/this.mul},h.prototype.updateInput=function(){this.input.value=""+this.val()},h.prototype.updateLbl=function(){this.value_format&&this.$lbl.text(this.value_format(this.val()))},h);function h(t,e,i,n,s){var r=this;this.options=s,this.mul=1,this.value_format=null,this.input=$j("<input style='display:none'>").appendTo(t)[0],s.mul&&(this.mul=s.mul);var o={min:e*this.mul,max:i*this.mul,value:n*this.mul},a=200;s.width&&(a=1*s.width),this.$div=$j("<div style='display:inline-block;width:"+a+"px;vertical-align:middle'>").appendTo(t).slider(o),s.style&&(this.$div[0].style.cssText+=";"+s.style),s.value_format&&(this.value_format=s.value_format,this.$lbl=$j("<span style='display:inline-block;margin-left:10px;color:#808080'>").appendTo(t)),this.ASC_ce=this.input.ASC_ce=new Ft.ASC_ce(this.$div),this.input.value=""+n,this.updateLbl(),this.$div.on("slidechange",function(){r.updateInput(),r.updateLbl(),r.ASC_ce.fire()}),this.$div.on("slide",function(){r.updateLbl()})}t.Slider=d;var p=(f.prototype.addRibbon=function(t,e){var i=this;this.keys.push(t),this.$labels[t]=$j("<span class='label'>").appendTo(this.$top).text(e).click(function(){i.select(t)});var n=new v(this.$bottom);return n.$container.parent().hide(),this.ribbons[t]=n,""==this.active&&this.select(t),n},f.prototype.select=function(t){var e=this.active;t!=e&&(this.$labels[e]&&this.$labels[e].removeClass("selected"),this.ribbons[e]&&this.ribbons[e].$container.parent().hide(),this.$labels[t].addClass("selected"),this.ribbons[t].$container.parent().show(),this.ribbons[t].options.autoResize&&$j(window).resize(),this.active=t)},f.prototype.findButton=function(t){for(var e=null,i=0;i<this.keys.length&&!(e=this.ribbons[this.keys[i]].findButton(t));i++);return e},f.prototype.findCombo=function(t){for(var e=null,i=0;i<this.keys.length&&!(e=this.ribbons[this.keys[i]].findCombo(t));i++);return e},f.prototype.findButtonsByCmd=function(t){for(var e=[],i=0,n=this.keys;i<n.length;i++)for(var s=n[i],r=0,o=this.ribbons[s].buttons;r<o.length;r++){var a=o[r];a.cmd==t&&e.push(a)}return e},f);function f(t){this.keys=[],this.$labels={},this.ribbons={},this.active="",this.$div=$j("<div class='asc-ribbon-menu'/>").appendTo(t),this.$top=$j("<div class='top'>").appendTo(this.$div),this.$right=$j("<div class='right'>").appendTo(this.$top),this.$bottom=$j("<div class='bottom'>").appendTo(this.$div),this.$div.get(0).ASC_rm=this}t.RibbonMenu=p;var v=(g.prototype.findButton=function(t){for(var e=null,i=0;i<this.buttons.length;i++)if((e=this.buttons[i]).id==t)return e;return null},g.prototype.findCombo=function(t){for(var e=0;e<this.combos.length;e++){var i=this.combos[e];if(i.id==t)return i}return null},g.prototype.resize=function(){if(this.$container.is(":visible")&&"row"==this.$container.css("flex-direction")){this.$container.removeClass("fullScreen");var t=this.$container.find(".asc-ribbon-group:not(.toggler):not(:has(.asc-ribbon-div))").get(),e=this.countAvailableWidth();if(e<0){t.sort(function(t,e){return parseInt($j(t).data("level"))<parseInt($j(e).data("level"))?-1:1});for(var i=0,n=t;i<n.length;i++){var s=n[i];if(!(e<0))break;this.minimizeGroup($j(s)),e=this.countAvailableWidth()}e<0&&this.toggleMiniText(t,e,!1)}else if(20<e){t.sort(function(t,e){return parseInt($j(t).data("level"))>parseInt($j(e).data("level"))?-1:1}),this.toggleMiniText(t,e,!0);for(var r=0,o=t;r<o.length&&(s=o[r],20<(e=this.countAvailableWidth()));r++)this.maximizeGroup($j(s))}}},g.prototype.countAvailableWidth=function(){var i=this.$container.width();return this.$container.find(".asc-ribbon-group:not(.toggler)").each(function(t,e){i-=e.clientWidth}),i},g.prototype.toggleMiniText=function(t,e,i){for(var n=0,s=t;n<s.length;n++){var r=s[n],o=$j(r).find(".asc-ribbon-minigroup").get();i||(o=o.reverse());for(var a=0,l=o;a<l.length;a++){var c=l[a];if($j(c).toggleClass("no-text",!i),e=this.countAvailableWidth(),i&&e<100||!i&&0<e)break}if(i&&e<100||!i&&0<e)break}},g.prototype.minimizeGroup=function(t){var e=t.find("> .asc-ribbon-button");if(1<e.length)for(var i=Math.ceil(e.length/3);0<=i&&!(0<this.countAvailableWidth());i--){var n=t.find(".asc-ribbon-minigroup.temp"),s=$j('<div class="asc-ribbon-minigroup temp">').append(e.eq(3*i+0)).append(e.eq(3*i+1)).append(e.eq(3*i+2));n&&n.length?s.insertBefore(n.first()):s.appendTo(t)}},g.prototype.maximizeGroup=function(t){var e=t.find("> .asc-ribbon-minigroup.temp");if(e.length)for(var i=0;i<e.length;i++){var n=e.eq(i).find(".asc-ribbon-button"),s=0;if(n.each(function(t,e){s+=$j(e).data("origWidth")}),!(this.countAvailableWidth()>s))break;e.eq(i+1).length?n.insertBefore(e.eq(i+1)):n.appendTo(t),e.eq(i).remove()}},g.prototype.fixWhiteSpace=function(){if(this.$container.width()>this.$container.parent().width())for(var t=0;t<this.buttons.length;t++){var e=this.buttons[t],i=e.$label.text();i=i.replace(" ","\n"),e.$label.text(i)}},g);function g(t,e){var i=this;void 0===e&&(e={}),this.options=e,this.menu=null,this.buttons=[],this.combos=[],"autoResize"in e||(e.autoResize=!0);var n=$j("<div>").appendTo(t).css("position","relative");this.$container=$j("<div class='asc-ribbon'/>").appendTo(n),this.$container.get(0).ASC_r=this,e.autoResize&&$j(window).resize(function(){clearTimeout(i.resizeHandler),i.resizeHandler=setTimeout(function(){i.resize()},100,i)}),this.$div=$j("<div class='left'>").appendTo(this.$container),this.$right=$j("<div class='right'>").appendTo(this.$container);var s=new Et.RibbonGroup(this);s.$div.addClass("toggler");var r=new Et.RibbonButton(s,"","",function(){i.$container.toggleClass("fullScreen"),$j(window).resize(),r.selected(i.$container.hasClass("fullScreen"))});r.$middle.find("img").remove(),r.$middle.append('<i class="fa fa-bars fa-fw" aria-hidden="true">')}t.Ribbon=v;var m=(b.prototype.addDiv=function(){return $j("<div class='asc-ribbon-div'>").appendTo(this.$div).get(0)},b.prototype.remove=function(){this.$div.children("div").each(function(t,e){var i=e.ASC_ri;i&&i.remove()}),this.$div.remove()},b);function b(t,e){void 0===e&&(e={}),this.ribbon=t,this.lastItem=null,this.$div=$j("<div class='asc-ribbon-group'/>").appendTo(e.right?this.ribbon.$right:this.ribbon.$div),this.$div.get(0).ASC_rg=this,e.level&&this.$div.data("level",e.level)}t.RibbonGroup=m;var y=function(t,e){void 0===e&&(e={}),this.group=t,this.items=[],this.$div=$j("<div class='asc-ribbon-minigroup'>").appendTo(t.$div),t.ribbon.options.autoResize&&this.$div.data("level",e.level||-1)};t.MiniGroup=y;function C(t,e,i,n){var s=this;this.menu=i,this.$a=$j("<a>").appendTo(t).text(e),n.style&&(this.$a.get(0).style.cssText+=";"+n.style),this.$a.click(function(t){Ft.showContextMenu(s.menu,t,s.$a)})}t.AnchorMenu=C;var _=($.prototype.remove=function(){this.$div.remove(),this.group.lastItem==this&&(this.group.lastItem=null)},$);function $(t,e){this.group=t,this.mini=null,this.$div=$j("<div>"),this.$div.get(0).ASC_ri=this,e?(t.lastItem&&t.lastItem.mini&&t.lastItem.mini.items.length<3?this.mini=t.lastItem.mini:(this.mini=new y(t),this.mini.items.push(this)),this.$div.appendTo(this.mini.$div)):this.$div.appendTo(t.$div),t.lastItem=this}var S,w=(__extends(x,S=_),x.prototype.enabled=function(t){return void 0!==t&&this.$div.toggleClass("disabled",!t),!this.$div.hasClass("disabled")},x.prototype.selected=function(t){return void 0!==t&&this.$div.toggleClass("selected",!!t),this.$div.hasClass("selected")},x.prototype.icon=function(t){this.$img.attr("src",staticUrl(t))},x.prototype.label=function(t){for(var e,i,n=15;;){i=r(t,n);for(var s=e=0;s<i.length;s++)"\n"==i.charAt(s)&&e++;if(e<=2)break;if(100<=n)break;n++}this.$label.empty(),1<e?this.$label.text(i).css("display","inline-block"):0==e&&12<=t.length?this.$label.text(t):this.$label.text(i),this.$label.toggleClass("mini",1<e||0==e&&12<=t.length)},x.prototype.remove=function(){S.prototype.remove.call(this);var t=this.group.ribbon;t.buttons.splice(t.buttons.indexOf(this),1)},x);function x(e,t,i,n,s){void 0===s&&(s={});var r=S.call(this,e,s.mini)||this;return r.onclick=n,r.id="",r.cmd="",r.nowrap=!1,r.menu=null,e.ribbon.buttons.push(r),r.$div.addClass("asc-ribbon-button"),r.$middle=$j("<div class='middle'/>").appendTo(r.$div),r.$img=$j("<img>").attr("src",i&&staticUrl(i)).appendTo(r.$middle),r.$label=$j("<span>").appendTo(r.$middle),r.$div.mousedown(function(t){t.preventDefault()}),r.$div.click(function(t){r.enabled()&&(0==r.$div.parents(".toggler").length&&e.ribbon.$container.removeClass("fullScreen"),r.menu?(r.$div.addClass("tmp-selected"),Ft.showContextMenu(r.menu,t,r.$div)):r.enabled()&&r.onclick&&r.onclick())}),s.id&&(r.id=s.id),s.cmd&&(r.cmd=s.cmd),s.nowrap&&(r.nowrap=!0),s.selected&&r.$div.addClass("selected"),s.menu&&(r.$div.addClass("menu"),r.menu=s.menu),!1!==s.enabled&&(s.menu||r.onclick)&&!s.disabled||r.$div.addClass("disabled"),r.label(t),s.tooltip&&r.$div.attr("title",s.tooltip),e.ribbon.options.autoResize&&(r.$div.data("origWidth",r.$div.outerWidth()),$j(window).resize()),r}t.RibbonButton=w;var A,k=(__extends(j,A=_),j.prototype.setItems=function(t){this.combo.setItems(t)},j.prototype.setValue=function(t,e){void 0===e&&(e=!1),this.combo.ASC_set(t,e)},j.prototype.setVisible=function(t){this.$div.toggle(!!t)},j.prototype.remove=function(){A.prototype.remove.call(this);var t=this.group.ribbon;t.combos.splice(t.combos.indexOf(this),1)},j);function j(e,i,t){void 0===t&&(t={});var n=A.call(this,e,!0)||this;n.id="";var s={fn:function(t){e.ribbon.$container.removeClass("fullScreen"),i(t)}};return t.multi?n.combo=new W(n.$div,[],t.items||[],s):n.combo=new N(n.$div,"",t.items||[],s),n.combo.$div.addClass("asc-ribbon-combo").width(t.width||100).attr("title",t.title),t.id&&(n.id=t.id),e.ribbon.combos.push(n),n}t.RibbonCombo=k;var T=(M.prototype.setSelectedId=function(t){for(var e=0;e<this.groups.length;e++)this.groups[e].setSelectedId(t)},M);function M(t){this.groups=[],this.$div=$j("<div class='asc-accordion'/>").appendTo(t)}t.Accordion=T;var I=(D.prototype.setSelectedId=function(t){for(var e=0;e<this.buttons.length;e++)this.buttons[e].selected(this.buttons[e].id==t)},D.prototype.collapsed=function(t){return void 0!==t&&this.$div.toggleClass("collapsed",!!t),this.$div.hasClass("collapsed")},D.prototype.hideIfEmpty=function(){0==this.buttons.length&&this.$div.hide()},D);function D(t,e,i){var n=this;void 0===i&&(i={}),this.accordion=t,this.buttons=[],t.groups.push(this),this.$div=$j("<div class='asc-accordion-group'/>").appendTo(t.$div),this.$top=$j("<div class='top'/>").appendTo(this.$div),this.$label=$j("<span class='label'/>").appendTo(this.$top),this.$label.text(e),this.$bottom=$j("<div class='bottom'/>").appendTo(this.$div),i.collapsed&&this.collapsed(!0),this.$top.click(function(){n.collapsed(!n.collapsed())})}t.AccordionGroup=I;var F=(E.prototype.selected=function(t){return void 0!==t&&(t?this.$div.addClass("selected"):this.$div.removeClass("selected")),this.$div.hasClass("selected")},E);function E(t,e,i,n,s){void 0===s&&(s={}),this.group=t,this.id="",t.buttons.push(this),this.$div=$j("<div class='asc-accordion-button'/>").appendTo(t.$bottom),(this.$div.get(0).ASC_obj=this).$icon=$j("<img/>").attr("src",staticUrl(i)).appendTo(this.$div),this.$label=$j("<span/>").text(e).appendTo(this.$div),s.id&&(this.id=s.id),n&&!s.disabled&&this.$div.click(n),s.disabled&&this.$div.addClass("disabled")}t.AccordionButton=F;var L=(P.prototype.select=function(t){if("string"==typeof t&&(t=this.findItem(t)),this.selected!=t){var e=!0;this.selected&&(this.selected.$row.removeClass("selected"),e=!1),this.selected=t,this.selected&&(this.selected.$row.addClass("selected"),e&&this.$div.parent().scrollTop(this.selected.$row.position().top-this.$div.parent().height()/2)),this.$div.trigger("select",this.selected)}},P.prototype.on=function(t,e){this.$div.on(t,e)},P.prototype.findItem=function(t){for(var e=0,i=this.rootItems;e<i.length;e++){var n=i[e].findItem(t);if(n)return n}return null},P.prototype.removeAll=function(){this.rootItems.splice(0,this.rootItems.length),this.$div.html("")},P);function P(t,e){var i=this;void 0===e&&(e={}),this.rootItems=[],this.flat=!1,this.selected=null,this.$div=$j("<div class='tree-view'>").appendTo(t),e.flat&&(this.flat=!0,this.$div.addClass("flat")),this.$div.on("select",function(t,e){i.$div.trigger("select_id",e.id)})}t.TreeView=L;var O=(H.prototype.updatePlus=function(){this.$plus.attr("src",staticUrl("/global/pics/ui/"+(this.expanded?"tree_minus.png":"tree_plus.png"))),this.expanded?this.$sub.show():this.$sub.hide()},H.prototype.setExpanded=function(t){this.expanded=Ft.boolVal(t),this.updatePlus(),this.expanded&&this.firstexpand&&(this.firstexpand=!1,this.tree.$div.trigger("firstexpand_id",this.id),this.tree.$div.trigger("firstexpand",this))},H.prototype.findItem=function(t){if(t==this.id)return this;for(var e=0,i=this.children;e<i.length;e++){var n=i[e].findItem(t);if(n)return n}return null},H);function H(t,e,i,n){var s=this;if(void 0===n&&(n={}),this.parent=null,this.children=[],this.leaf=!1,this.expanded=!1,this.firstexpand=!0,this.id="",this.data=null,t instanceof L)this.tree=t,this.tree.rootItems.push(this);else{if(!(t instanceof H))throw"Error4474294123";this.parent=t,this.tree=this.parent.tree,t.children.push(this)}this.leaf=Ft.boolVal(n.leaf),n.expanded&&!this.leaf&&(this.expanded=!0),this.$div=$j("<div>").appendTo(this.parent?this.parent.$sub:this.tree.$div),this.$row=$j("<div class='item'>").appendTo(this.$div),this.$plus=$j("<img class='plus'>").appendTo(this.$row),i&&(this.$icon=$j("<img class='icon'>").appendTo(this.$row).attr("src",staticUrl(i))),this.$label=$j("<span class='label'>").appendTo(this.$row).text(e),n.style&&(this.$label[0].style.cssText+=";"+n.style),this.$sub=$j("<div class='sub'>").appendTo(this.$div),this.updatePlus(),this.$row.click(function(){s.tree.select(s)}),this.leaf?this.$plus.css("visibility","hidden"):(this.$row.dblclick(function(){s.setExpanded(!0)}),this.$plus.click(function(t){s.setExpanded(!s.expanded),t.stopImmediatePropagation()})),n.id&&(this.id=n.id),"data"in n&&(this.data=n.data)}t.TreeViewItem=O;var q=(z.prototype.addTab=function(t){var e=this;t.index=this.tabs.length,this.tabs.push(t),t.$label.appendTo(this.$labels).click(function(){e.selectTab(t.index)}),this.lazyLoad||t.$container.appendTo(this.$content).trigger("load")},z.prototype.selectTab=function(t){var e=this;if(this.tabs.length&&(0<this.counter||600<window.innerWidth)){var i=this.tabs[t];this.$labels.find(">div.selected").removeClass("selected"),i.$label.addClass("selected");var n=this.$content.find(">div.active").removeClass("active");this.lazyLoad&&0==i.$container.parents(".asc-tab-view").length&&i.$container.appendTo(this.$content).trigger("load"),this.$content.addClass("active"),i.$container.addClass("active").trigger("visible"),$j(document.body).addClass("some-content-active"),!this.options.skipFixDimensions&&600<window.innerWidth&&600<window.innerHeight&&window.setTimeout(function(){0==i.$container.find(".fitHeight").length&&e.fixDimensions(i,0==n.length)},100)}this.counter++},z.prototype.selectTabByElement=function(t){for(var e=Ft.isArray(t)?t:[t],i=0,n=this.tabs;i<n.length;i++){for(var s=n[i],r=!1,o=0,a=e;o<a.length;o++){var l=a[o];$j.contains(s.$container[0],l)&&(r=!0)}if(r)return this.selectTab(s.index),!0}return!1},z.prototype.fixDimensions=function(t,e){this.maxHeight=Math.max(t.$container.outerHeight(),this.maxHeight),this.maxWidth=Math.max(t.$container.outerWidth(),this.maxWidth);var i=this.$div.parents(".ui-dialog"),n=i.get(0)&&"auto"==i.get(0).style.width,s=i.innerWidth();if(10<this.maxHeight){var r=window.innerHeight-this.$div.position().top-1;this.$content.css("min-height",Math.min(r,this.maxHeight)+"px")}e||n&&100<this.maxWidth&&this.maxWidth<s&&this.$content.css("min-width",this.maxWidth+"px"),i.length&&i.outerHeight()+i.position().top>window.innerHeight&&i.find(".ui-dialog-content").get(0).ASC_dlg.center()},z.prototype.set=function(t,e){switch(t){case"orientation":this.$div.toggleClass("orientation-left","left"==e);break;case"lazyLoad":this.lazyLoad=e}},z);function z(t,e){void 0===e&&(e={}),this.options=e,this.maxHeight=0,this.maxWidth=0,this.lazyLoad=!1,this.counter=0,this.$div=$j("<div class='asc-tab-view'>").appendTo(t),this.$labels=$j("<div class='labels'>").appendTo(this.$div),this.$content=$j("<div class='content'>").appendTo(this.$div),$j("<div class='close-btn'>").text(Ft.ls(1567)).appendTo(this.$div).click(function(){var t=$j(".asc-tab-view .content.active");t.last().removeClass("active"),$j(".asc-tab-view .labels .selected").last().removeClass("selected"),t.length<=1&&$j(document.body).removeClass("some-content-active")}),this.tabs=[]}t.TabView=q;function B(t){this.options=t,this.$container=$j("<div>").html(t.content),this.$label=$j("<div>").text(t.label),t.icon&&$j("<img>").attr("src",staticUrl(t.icon)).prependTo(this.$label)}t.Tab=B;var N=(V.prototype.createElement=function(){var t=$j("<a href='#'>");this.btn=t.get(0),this.$label=$j("<span class='button-title'>").appendTo(t),t.appendTo(this.$div)},V.prototype.setItems=function(t){this.items=this.convertToMenu(V.fixItems(t)),this.$label&&this.$label.length&&this.update()},V.prototype.isOpen=function(){return Ft.showContextMenuOpened(this.$div)},V.prototype.open=function(t){if(!this.isOpen()){var e=Ft.showContextMenu(this.items,t,{cd:this.$div,clickToHide:!1,cssClass:"asc-combo"});this.fixMenu(e)}},V.prototype.fixMenu=function(t){t.$menu.find(".asc-context-menu").removeClass("asc-context-menu")},V.prototype.click=function(t){this.ASC_set(t),this.hide()},V.prototype.hide=function(){Ft.hideContextMenu(),this.$div.find("a").focus()},V.prototype.ASC_set=function(t,e){void 0===e&&(e=!0),this.value=t,this.update(),this.linked_field&&(this.linked_field.value=this.value),e&&this.$div.trigger("ASC_ce",this.value)},V.prototype.update=function(){var n=this,s=[],r={};if(this.walkItems(function(t,e){var i=n.isChecked(t.value);(t[n.checkProperty]=i)&&!r[t.value]&&(r[t.value]=!0,s.push(n.getItemName(t)))}),0<this.maxLabelItems&&s.length>this.maxLabelItems){var t=s.length;(s=s.slice(0,this.maxLabelItems)).push(" ... ("+t+")")}if(!this.fixedLabel){var e=s.join(", ");0!=s.length||Ft.isArray(this.value)||(e=Ft.strVal(this.value)),this.$label.html(e+"Â "),this.$label.attr("title",this.$label.text())}},V.fixItems=function(e){if("length"in e)for(var t in e)try{if(!("value"in e[t]))break}catch(t){e=V.convertToCombo(e)}else e=V.convertToCombo(e);return Ft.clone(e)},V.convertToCombo=function(t){var e=[];for(var i in t)e.push({value:i,name:t[i]});return e},V.prototype.convertToMenu=function(t){var i=this;return _t.convertCombo(t,this.value,function(t,e){i.click(e)})},V.prototype.getTexts=function(t){for(var e=[],i=0,n=this.getLabelItems(t);i<n.length;i++){var s=n[i];e.push(this.getItemName(s))}return e},V.prototype.getLabelItems=function(t){for(var e=[],i=0;i<t.length;i++)e=e.concat(this.findItems(t[i]));return e},V.prototype.getItemName=function(t){return t.text?t.text:t.html?yt.renderContent($j("<li>"),t).html():""},V.prototype.setDefaultItem=function(i){this.walkItems(function(t,e){"value"in t&&""==t.value&&(t.text=Ft.ls(1858)+(i?" ("+i+")":""))}),this.update()},V.prototype.isChecked=function(t){return Ft.strEquals(this.value,t)},V.prototype.findItems=function(i,n){void 0===n&&(n="value");var s=[];return this.walkItems(function(t,e){Ft.strEquals(t[n],i)&&s.push(t)}),s},V.prototype.walkItems=function(t){for(var e=0,i=0,n=0;n<this.items.length;n++)"object"==Ft.type(this.items[n])?t(this.items[n],e++,i):(i++,e=0)},V.prototype.getValue_label=function(){return this.getTexts([this.value])[0]},V.prototype.setValue_label=function(i){var n=this,s=!1;return this.walkItems(function(t,e){!s&&Ft.strEquals(n.getItemName(t),i)&&(n.ASC_set(t.value),s=!0)}),s},V);function V(t,e,i,n){var s=this;void 0===n&&(n={}),this.items=[],this.maxLabelItems=0,this.fixedLabel=!1,this.checkProperty="selected",this.$div=$j("<div class='dropDownBtn asc-combo'>"),this.$div.get(0).ASC_combo=this,n.anchor&&(this.$div.addClass("anchor"),n.anchor.length&&$j("<label>").text(n.anchor).appendTo(this.$div)),n.style&&("object"==typeof n.style?this.$div.css(n.style):this.$div.get(0).style.cssText+=n.style),this.value=null===e?"":e,this.setItems(i),this.createElement(),this.$div.click(function(t){t.preventDefault(),t.stopImmediatePropagation(),s.isOpen()?s.hide():s.open(t)}),n.maxWidth&&this.$label.css({maxWidth:n.maxWidth}).addClass("ellipsis"),n.fixedLabel&&(this.$label.html(n.fixedLabel),this.fixedLabel=!0),n.linked_field&&(this.linked_field=n.linked_field,(this.linked_field.ASC_combo=this).linked_field.ASC_uiElement=this.$div,this.linked_field.ASC_set=function(t,e){s.ASC_set(t,e)},this.linked_field.ASC_ce=new Ft.ASC_ce(this.$div)),n.fn&&this.$div.on("ASC_ce",function(){n.fn(s.value)}),n.disabled&&this.$div.off().click(function(t){t.preventDefault(),t.stopPropagation()}).css("background-color","initial"),this.ASC_set(this.value,!1),this.$div.appendTo(t)}t.ComboBox=N;var R,W=(__extends(U,R=N),U.prototype.fixMenu=function(t){return t&&(R.prototype.fixMenu.call(this,t),t.$menu.find(".dropDownPanel").addClass("checkPanel"),this.options.controls&&t.cfg.setProperty("header",this.getControlsHTML())),this.menu=t},U.prototype.isChecked=function(t){return 0<=Ft.indexOf2(this.value,t)},U.prototype.click=function(t){var n=this,e=Ft.indexOf2(this.value,t);if(e<0){var i=this.findItems(t);if(1!=i.length)throw"Error9970882172";if("radiogroup"in i[0]){var s=i[0].radiogroup;this.walkItems(function(t,e){if(t.radiogroup==s){var i=Ft.indexOf2(n.value,t.value);0<=i&&n.value.splice(i,1)}})}this.value.push(t)}else this.value.splice(e,1);this.ASC_set(this.value),this.menu.items=this.menu.initItems(this.items),this.menu.renderItems(),this.fixMenu(this.menu)},U.prototype.convertToMenu=function(t){for(var e={},i=0,n=t;i<n.length;i++){var s=n[i];s&&"value"in s&&(e[s.value]=!0)}for(var r=!1,o=0;o<this.value.length;o++)this.value[o]in e||(r||(r=!0,t.push([])),t.push({name:this.value[o],value:this.value[o]}));return R.prototype.convertToMenu.call(this,t)},U.prototype.update=function(){this.checkProperty="checked",R.prototype.update.call(this)},U.prototype.getControlsHTML=function(){var i=this,t=$j("<div>");return $j("<img>").appendTo(t).attr({src:staticUrl("/asc/pics/icons/check_16.png"),height:"10px",title:Ft.ls(4288)}).click(function(){var e=[];i.walkItems(function(t){e.push(t.value)}),i.ASC_set(e)}),$j("<img>").appendTo(t).attr({src:staticUrl("/asc/pics/icons/delete_16.png"),title:Ft.ls(4289)}).click(function(){i.ASC_set([])}),$j("<img>").appendTo(t).attr({src:staticUrl("/asc/pics/icons/refresh_16.png"),title:Ft.ls(6626)}).click(function(){var e=[];i.walkItems(function(t){Ft.indexOf(i.value,t.value)<0&&e.push(t.value)}),i.ASC_set(e)}),t.find("img").css({marginRight:"0.5em",verticalAlign:"middle",height:"16px"}),t},U);function U(t,e,i,n){void 0===n&&(n={});var s=R.call(this,t,e,i,n)||this;if(s.options=n,!Ft.isArray(s.value)){if(s.value)throw"Error5374882239";s.value=[]}return 0<n.maxLabelItems&&(s.maxLabelItems=n.maxLabelItems),s.ASC_set(s.value,!1),s}t.ComboBoxMulti=W;var Y=(J.prototype.ASC_set=function(t,e){void 0===e&&(e=!0),this.value=t,this.update(),this.linked_field&&(this.linked_field.value=this.value),e&&this.$input.trigger("ASC_ce",this.value)},J.prototype.update=function(){for(var t=this.value,e=!1,i=0;i<this.items.length;i++)this.items[i].value==this.value&&(e=!0,t=this.items[i].label);this.$input.val(t),this.options.addFn&&this.$container.find("a.add").toggle(!e&&""!=t)},J.prototype.fixItems=function(t){var e=N.fixItems(t);return e.forEach(function(t){t.text||(t.text=t.name),t.label=t.text}),e},J.prototype.getSource=function(t){if(this.options.getItems)var e=this.options.getItems(t);else{var i=new RegExp($j.ui.autocomplete.escapeRegex(t),"i");e=$j.grep(this.items,function(t){return i.test(t.label)})}return 0==e.length&&""!=t&&this.options.addFn&&e.push({text:Ft.ls(3572),label:Ft.ls(3572),value:this.value,add:t+""}),e},J.prototype.setNewItem=function(t){this.items.push(t),this.items=this.fixItems(this.items),this.$input.blur(),this.ASC_set(t.value)},J);function J(t,e,i,n){var s=this;this.options=n,this.$container=$j("<span>").appendTo(t).addClass("asc-autocomplete"),this.items=this.fixItems(i),$j.widget("ui.autocomplete",$j.ui.autocomplete,{_renderItem:function(t,e){var i=$j("<li>").appendTo(t);return yt.renderContent(i,e),i.find("img").css({paddingRight:".5em",verticalAlign:"middle"}),i}}),$j.widget("ui.menu",$j.ui.menu,{_isDivider:function(t){return"-"!=t.text()&&this._super(t)}});function r(t,e){return e.item&&s.$input.val(e.item.text),!1}var o=!1;this.$input=$j("<input>").appendTo(this.$container).autocomplete({minLength:0,source:function(t,e){e(s.getSource(t.term))},select:function(t,e){return e.item&&e.item.add&&n.addFn?(n.addFn(t,e.item.add+"",s),s.ASC_set(s.value,!1)):s.ASC_set(e.item?e.item.value:s.value,!1),!1},focus:function(t,e){return r(0,e),s.$input.select(),!1},close:r,change:function(t,e){return e.item||s.items&&s.items.find(function(t){return""==t.value})&&(s.value=""),s.ASC_set(e.item?e.item.value:s.value),!1}}).css("padding-right","1em").focus(function(){""==s.value&&s.$input.val("")}).blur(function(){""==s.value&&""==s.$input.val()&&s.update()});var a=this.$input.height();$j("<a>").appendTo(this.$container).attr("tabIndex",-1).attr("title",Ft.ls(3196)).addClass("show-all").css({left:this.$input.width(),width:a,height:a}).mousedown(function(){o=s.$input.autocomplete("widget").is(":visible")}).click(function(){s.$input.focus(),o||s.$input.autocomplete("search","")}),n.style&&(this.$input.get(0).style.cssText+=";"+n.style),n.cssClass&&this.$input.addClass(n.cssClass),n.linked_field&&(this.linked_field=n.linked_field,(this.linked_field.ASC_combo=this).linked_field.ASC_uiElement=this.$input,this.linked_field.ASC_set=function(t,e){s.ASC_set(t,e)},this.linked_field.ASC_ce=new Ft.ASC_ce(this.$input)),this.ASC_set(e,!1)}t.ComboBoxAutoComplete=Y;var G=(X.prototype.setValue=function(t){(this.value=t)?this.$field.datepicker("setDate",Ft.date_sql2js(t)):this.$field.val(this.nodate),this.linked_field&&(this.linked_field.value=t,this.$field.change()),this.$field.removeClass("asc-badfieldvalue")},X);function X(t,e,i){var n=this;if(void 0===i&&(i={}),this.value="",this.$field=$j("<input type='text' class='asc-textfield asc-datefield'>").appendTo(t),this.nodate=i.nodate||"",i.style&&(this.$field.get(0).style.cssText=i.style),i.nodate&&(i.showButtonPanel=!0,i.closeText=i.nodate,i.onClose=function(t,e){e.dpDiv.find("button.ui-datepicker-close").hasClass("ui-state-hover")&&(n.setValue(""),n.$field.trigger("change"))}),"week"==i.calendarmode&&(i.beforeShow=function(t,e){return setTimeout(function(){e.dpDiv.find("a.ui-state-active").parents("tr").addClass("selected-range-day")},100),i}),i.navigator&&(i.changeMonth=!0,i.changeYear=!0),i.highlightdates2)throw"Error6802836505 - TODO highlight dates";this.dp=new Z(this.$field,i),this.$field.change(function(){var t=n.$field.val(),e=!0;if(""==t)n.value="";else try{$j.datepicker.parseDate(n.$field.datepicker("option","dateFormat"),t)?n.value=Ft.date_js2sql(n.$field.datepicker("getDate")):e=!1}catch(t){e=!1}n.linked_field&&$j(n.linked_field).val(n.value),Ft.setClass(n.$field.get(0),"asc-badfieldvalue",!e)}),i.linked_field&&(this.linked_field=i.linked_field,this.linked_field.ASC_uiElement=this.$field,this.linked_field.ASC_set=function(t){n.setValue(t)},this.linked_field.ASC_cal=this.dp,this.linked_field.ASC_ce={subscribe:function(e){n.$field.change(function(t){e(t,n.value)})}}),this.setValue(e),i.highlightdates&&this.dp.fillRenderers(i.highlightdates)}t.DateField=G;var Z=(K.getDateFormat=function(){return Ft.req_props.dtFormats.date},K.getDayNamesShort=function(){return K.dayShort.map(function(t){return Ft.ls(t)})},K.getSettings=function(){var t=[];for(var e in K.monthNames)t.push(Ft.ls(K.monthNames[e]));return{dateFormat:K.getDateFormat(),dayNames:K.dayNames,dayNamesMin:K.getDayNamesShort(),monthNames:t,firstDay:Ft.timezone_firstDayOfWeek()%7,currentText:Ft.ls(6136),weekHeader:"KW",beforeShow:function(t,e){setTimeout(function(){e.dpDiv.css("z-index",99999999999999)},0)}}},K.prototype.subscribe=function(i){var n=this;this.$container.datepicker("option","onSelect",function(t,e){i(n.getSqlDate(),e)})},K.prototype.setRenderer=function(t){this.$container.datepicker("option","beforeShowDay",t)},K.prototype.getSqlDate=function(t){return $j.datepicker.formatDate("yy-mm-dd",t||this.$container.datepicker("getDate"))},K.prototype.fillRenderers=function(t){if(t){var o=Array.isArray(t)?t:[t];this.setRenderer(function(t){for(var e=[!0,"",""],i=Ft.date_js2sql(t),n=0,s=o;n<s.length;n++){var r=s[n];r.dates&&0<=r.dates.indexOf(i)&&(e=[r.selectable||!0,r.class,r.tooltip||""])}return e})}},K.dayShort=[9583,9577,9578,9579,9580,9581,9582],K.dayNames=[1709,1703,1704,1705,1706,1707,1708],K.monthNames=[1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722],K);function K(t,e){e=$j.extend({},K.getSettings(),e),this.$container=$j(t).datepicker(e)}t.DatePicker=Z;var Q=(tt.prototype.initField=function(t){var s=this;if(this.inputs.push($j("<input type='hidden'>").appendTo(t)),this.options.dateInput){var e=$j("<input type='text'>").appendTo(t).css("margin","0 5px").keyup(function(){for(var t=!1,e=!0,i=0;i<s.fields.length;i++){if(s.fields[i].val().length%10!=0)return;if(s.inputs[i].val()!=s.fields[i].val()){var n=Ft.date_sql2js(s.fields[i].val());0==i?(s.datefrom=Ft.date_js2sql(n),s.datefrom>s.dateto&&(s.dateto=Ft.date_js2sql(n),e=!1)):(s.dateto=Ft.date_js2sql(n),s.datefrom>s.dateto&&(s.datefrom=Ft.date_js2sql(n),e=!1)),t=!0}}t&&(s.refresh(),s.setState(),e&&s.ok())});this.fields.push(e)}},tt.prototype.setState=function(){this.state=this.datefrom&&this.dateto?2:this.datefrom||this.dateto?1:0},tt.prototype.ok=function(){this.options.okfunc&&this.options.okfunc(this.datefrom,this.dateto)},tt.prototype.select=function(){var t=this.datePicker.getSqlDate();"datefrom"==this.selectNext?(t==this.datefrom?this.dateto=t:t>this.dateto?(this.datefrom=t,this.dateto=t):this.datefrom=t,this.selectNext="dateto"):(t==this.dateto?this.datefrom=t:(t<this.datefrom&&(this.datefrom=t),this.dateto=t),this.selectNext="datefrom"),this.refresh(t),this.ok()},tt.prototype.refresh=function(t){if(!t&&0<this.state&&(t=this.datefrom?this.datefrom:this.dateto),t&&((!this.datefrom||t<this.dateto)&&(this.datefrom=t),(!this.dateto||this.datefrom&&t>this.datefrom)&&(this.dateto=t)),this.datefrom&&this.dateto&&(this.inputs[0].val(this.datefrom),this.inputs[1].val(this.dateto),this.fields.length))for(var e=0;e<this.fields.length;e++)this.fields[e].val(this.inputs[e].val()),this.fields[e].toggleClass("border_error","datefrom"==this.selectNext&&0==e||"dateto"==this.selectNext&&1==e);this.datePicker.$container.datepicker("setDate",Ft.date_sql2js(this.dateto)),this.datePicker.$container.datepicker("setDate",Ft.date_sql2js(this.datefrom))},tt);function tt(t,e,i,n){var s=this;void 0===n&&(n={}),this.options=n,this.inputs=[],this.fields=[],this.selectNext="datefrom",n.multi_select=!0,n.numberOfMonths=2;var r=Ft.createDiv(t,n.cssClass,"margin:10px 0;"+n.style);if(this.initField(r),this.initField(r),this.datePicker=new Z(r,n),e&&i&&i<e){var o=e+"";e=i,i=o}this.datefrom=e||"",this.dateto=i||"",this.setState(),this.datePicker.subscribe(function(t,e){s.select()}),this.datePicker.setRenderer(function(t){var e=[!0,"",""],i=s.datePicker.getSqlDate(t);return i>=s.datefrom&&i<=s.dateto&&(e[1]="selected-range-day"),e}),this.refresh()}t.DatePickerDiv=Q;var et=(it.prototype.init=function(t){var e=this;this.$panel=$j("<div>").appendTo(t).hide().blur(function(){e.hide()})},it.prototype.popup=function(){this.needRefill()&&this.fill(),this.$panel.show()},it.prototype.needRefill=function(){return!this.$panel.html()},it.prototype.fill=function(){this.$panel.empty()},it.prototype.hide=function(){this.$panel.fadeOut()},it);function it(t,e){void 0===e&&(e={}),this.options=e,this.init(t)}t.Popup=et;var nt,st=(__extends(rt,nt=et),rt.prototype.init=function(t){var r=this,e=Ft.createDiv(t,"inputComplete");nt.prototype.init.call(this,e),this.$panel.addClass("asc-scrollbar"),this.$ui=$j("<input>").appendTo(e).focus(function(){r.popup()}).keydown(function(t){switch(t.keyCode){case 13:var e=r.$panel.find(".selected").index(),i=0;for(var n in r.items){if(e==i){r.set(n),r.hide();break}i++}break;case 38:case 40:t.preventDefault(),t.stopPropagation();var s=r.$panel.find(".selected").removeClass("selected");s.length&&(s=38==t.keyCode?s.prev():s.next()),s.length||(s=38==t.keyCode?r.$panel.find("span:first-child"):r.$panel.find("span:last-child")),s.addClass("selected")}}).keyup(function(t){switch(t.keyCode){case 13:case 38:case 40:break;default:r.timeHandler&&clearInterval(r.timeHandler),r.timeHandler=setInterval(function(){clearInterval(r.timeHandler),r.scroll()},100)}}).blur(function(t){if(Ft.isIE())return!1;$j(t.relatedTarget).is(".ui-dialog")?$j(t.relatedTarget).click(function(){$j(t.relatedTarget).off("click"),r.onblur(t)}):r.onblur(t)})},rt.prototype.onblur=function(t){this.hide()},rt.prototype.popup=function(){$j(".asc-scrollbar").not(this.$panel).fadeOut(),nt.prototype.popup.call(this),this.scroll()},rt.prototype.fill=function(){var e=this;for(var t in nt.prototype.fill.call(this),this.items){var i=this.items[t]+(this.options.setItemLabel?" ("+t+")":""),n=$j("<span>").text(i).appendTo(this.$panel);!function(t){n.click(function(){e.set(t),e.hide()})}(t)}},rt.prototype.set=function(t){this.options.setItemLabel&&(t=this.items[t]),this.$ui.val(t),"function"==Ft.type(this.options.fn)&&this.options.fn(t)},rt.prototype.scroll=function(){this.$panel.show();var t=this.$ui.val().trim();this.$panel.html()&&t&&(this.$panel.children().removeClass("selected"),this.$panel.scrollTop(0),this.scrollTo(t).addClass("selected"))},rt.prototype.scrollTo=function(t){var e,i,n=0,s=t.length,r=t.substr(0,3)+"00";for(var o in this.items){if(this.matchValue(o,t,s)||this.matchValue(this.items[o],t,s)){e=this.$panel.children().eq(n);break}(this.matchValue(o,r,s)||this.matchValue(this.items[o],r,s))&&(i=this.$panel.children().eq(n)),n++}return e?this.$panel.scrollTop(e.position().top-Math.floor(this.options.rows/2)*e.height()):i&&this.$panel.scrollTop(i.position().top-Math.floor(this.options.rows/2)*i.height()),e||$j()},rt.prototype.matchValue=function(t,e,i){function n(t){return(t+"").toLowerCase().substr(0,i)}return n(t)==n(e)},rt);function rt(t,e,i){void 0===i&&(i={});var n=nt.call(this,t,i)||this;return n.items=e,n}t.InputComplete=st;var ot,at,lt=(__extends(ct,ot=st),ct.prototype.init=function(t){this.options=$j.extend({},{step:1800,rows:7},this.options),this.options.ajSekundy=!!this.options.ajSekundy||this.options.step<60,this.$el=$j('<input type="hidden">').appendTo(t),ot.prototype.init.call(this,t),this.$panel.css({"max-height":16*this.options.rows+"px","text-align":"left"}).parent().addClass("timePicker")},ct.prototype.onblur=function(t){ot.prototype.onblur.call(this,t);var e=this.options.emptyString&&""==this.$ui.val().trim()?"":Ft.ASC_str2time(this.$ui.val());this.set(e),this.send()},ct.prototype.scroll=function(){ot.prototype.scroll.call(this),this.get()||this.options.getFromField||this.scrollTo(this.options.scrollTo||"8:00")},ct.prototype.get=function(t){void 0===t&&(t=!1);var e=this.$el.val();return t?e:e.substring(0,5)},ct.prototype.set=function(t,e){t=Ft.strVal(t),this.options.valBezSekund&&(t=t.substr(0,5)),this.$el.val(t),this.$ui.val(Ft.ASC_time2str(t,{ajSekundy:this.options.ajSekundy})),e||"function"!=Ft.type(this.options.fn)||this.options.fn(t),this.send()},ct.prototype.duration=function(t,e){var i=this.time2seconds(e)-this.time2seconds(t),n=this.seconds2time(i),s=n[1]+Math.round(n[2]/6)/10;return 0<n[0]?Ft.lsf(3147,{n:n[0]})+(s?" "+Ft.lsf(1959,{n:1*s}):""):0<n[1]?Ft.lsf(1959,{n:1*s}):n[2]||this.options.ajSekundy?Ft.lsf(3148,{n:n[2]}):Ft.lsf(1959,{n:0})},ct.prototype.seconds2time=function(t){var e=[0,0,0];return e[0]=Math.floor(t/3600),e[1]=Math.floor((t-3600*e[0])/60),e[2]=t-3600*e[0]-60*e[1],e},ct.prototype.time2seconds=function(t){return"array"!=Ft.type(t)&&(t=Ft.ASC_str2time(t).split(":")),3600*t[0]+60*t[1]+1*t[2]},ct.prototype.needRefill=function(){return ot.prototype.needRefill.call(this)||this.options.getFromField},ct.prototype.fill=function(){this.items={};var t=0;for(this.options.getFromField&&this.options.getFromField.value&&(t=this.time2seconds(this.options.getFromField.value));t<=86400;t+=this.options.step){var e=Ft.ASC_str2time(this.seconds2time(t).join(":")),i=Ft.ASC_time2str(e,{ajSekundy:this.options.ajSekundy});if(this.options.getFromField)i+=" ("+this.duration(this.options.getFromField.value,e)+")";else if(86400==t)continue;this.items[e]=i}ot.prototype.fill.call(this)},ct.prototype.send=function(){this.ASC_ce.fire()},ct);function ct(t,e,i){void 0===i&&(i={});var n=ot.call(this,t,{},i)||this;return n.ASC_ce=new Ft.ASC_ce(n.$el),e&&n.set(Ft.ASC_str2time(e),!0),n}function ut(t,i){var e=t.find("tr").map(function(t,e){if(t<i)return $j(e).addClass("fixed"),$j("td, th",e).each(function(t,e){Ft.todo_read(function(){var t=pt(e);Ft.todo_write(function(){$j(e).css(t)})})}).get()});return Ft.todo_finish(),e}function dt(t,s){var r=0,o=0;return t.find("tr").map(function(t,e){var i=$j(e).find("td, th");if(0<o&&--o,i.length){var n=o;return i.map(function(t,e){if(t<s-(n?r||1:-r))return 1<e.rowSpan&&(o+=e.rowSpan),r+=e.colSpan-1,ht(e),e}).get()}})}function ht(t){$j(t).css(pt(t))}function pt(t){var e=$j(t),i=ft(e.css("background-color"));return{backgroundColor:"white"==i?ft(e.parent().css("background-color")):i}}function ft(t){if(!t||0<=t.indexOf("transparent")||0<=t.indexOf("none")||"rgba(0, 0, 0, 0)"==t)t="white";else if(0<=t.indexOf("rgba")){var e=t.substr(5,t.length-6).split(", "),i=parseFloat(e[3]),n=0;for(var s in e)if(s<"3"){var r=parseInt(e[s]),o=r*i+255*(1-i);e[s]=o+"",n+=r}t=10<n?"rgb("+e[0]+","+e[1]+","+e[2]+")":"white"}return t}function vt(t,e,i){var n=t.get(0).offsetLeft+t.get(0).clientLeft+parseInt(t.css("border-left-width"))||0;i&&(n-=$j(i).get(0).offsetLeft+$j(i).get(0).clientLeft-Math.max(t.offsetParent().get(0).offsetLeft,0));var s=t.width()-t.find("tr").first().children().get(e).offsetLeft,r=$j(i||window).scrollLeft()-n;return 0<r&&r<s?r:0}function gt(t,e,i){var n=t.get(0).offsetTop+t.get(0).clientTop+parseInt(t.css("border-top-width"))||0;i&&(n-=$j(i).get(0).offsetTop+$j(i).get(0).clientTop-Math.max(t.offsetParent().get(0).offsetTop,0));var s=t.height()-t.find("tr").get(e).offsetTop,r=$j(i||window).scrollTop()-n;return 0<r&&r<s?r:0}function mt(t,e,i){void 0===i&&(i=0);var n=0<e||0<i;t.css(Ft.getCssCrossBrowser("transform","translate("+e+"px, "+i+"px)",n)).toggleClass("fixed",n)}function bt(t,e,i,n){t["fixTable_moveFn"+i]&&$j(n||window).off("scroll",t["fixTable_moveFN"+i]),$j(n||window).on("scroll",e),t["fixTable_moveFN"+i]=e}t.TimePicker=lt,(at=t.FixedTable||(t.FixedTable={})).fixBoth=function(t,i,n,s){var r=$j(t).addClass("fixed");"chrome"!=Ft.browser&&r.addClass("noChrome");var o=ut(r,i),a=dt(r,n),l=o.filter(a);a=a.not(l),o=o.not(l),l.addClass("both"),bt(t,function(){var t=gt(r,i,s),e=vt(r,n,s);mt(l,e,t),mt(o,0,t),mt(a,e)},"both",s)},at.fixColumns=function(t,e,i){var n=$j(t).addClass("fixed"),s=dt(n,e);bt(t,function(){var t=vt(n,e,i);mt(s,t)},"left",i),$j(t).change(function(t){s.each(function(t,e){$j(e).css("background-color",""),ht(e)})})},at.fixRows=function(t,e,i){var n=$j(t).addClass("fixed"),s=ut(n,e);bt(t,function(){var t=gt(n,e,i);mt(s,0,t)},"top",i)};var yt=(Ct.prototype.render=function(t){var i=this;t.off().empty().addClass(this.config.CSS_CLASS_NAME).toggleClass("disabled",!!this.config.disabled).toggleClass("checked",!!this.config.checked).toggleClass("marked",!!this.config.selected),Ct.renderContent(t,this.config),this.$srcElement=t,!this.config.disabled&&this.config.onclick&&this.config.onclick.fn&&t.click(function(t){t.stopPropagation();var e="obj"in i.config.onclick?i.config.onclick.obj:i.config;i.config.onclick.fn(t,e,e),i.parent.config.clickToHide&&i.parent.hide()}),this.config.submenu&&t.addClass("submenu").click(function(t){t.preventDefault(),i.config.disabled||i.showSubmenu()}).hover(function(){i.config.disabled||(t.addClass("focused"),setTimeout(function(){t.hasClass("focused")&&i.showSubmenu()},200))},function(){i.config.disabled||(t.removeClass("focused"),setTimeout(function(){t.hasClass("focused")||i.hideSubmenu()},600))}),this.submenu&&this.initSubmenu()},Ct.renderContent=function(t,e){var i=$j("<a>").addClass(e.CSS_LABEL_CLASS_NAME).toggleClass("elementDisabled",!!e.disabled).html(e.html||e.text||String.fromCharCode(160));return e.icon&&$j("<img>").addClass("asc-icon-label").attr("src",staticUrl(e.icon)).prependTo(i),e.color&&$j("<i>").addClass("asc-color-label").css({backgroundColor:e.color}).prependTo(i),e.style&&(i.get(0).style.cssText+=e.style),e.indent&&i.css("padding-left",e.indent+"em"),i.appendTo(t)},Ct.prototype.getLabel=function(){return this.config.html&&this.config.text?this.config.text:this.$srcElement.find("a").html()},Ct.prototype.getText=function(){return this.$srcElement.find("a").text()},Ct.prototype.showSubmenu=function(){if(this.submenu||this.initSubmenu(),!this.submenu.$menu.is(":visible")){this.parent.$menu.find(".submenu .dropDown").not(this.submenu.$menu).hide(),this.fixSubmenuOffset(),this.submenu.$menu.css({display:"block",visibility:"hidden"});var t=this.submenu.fixOffset();this.submenu.$menu.css({display:"none",visibility:"visible"}),t?this.submenu.$menu.show("slide",{direction:"down"},150):this.submenu.$menu.slideDown(150,"swing")}},Ct.prototype.fixSubmenuOffset=function(){var t=this.$srcElement.offset(),e=$j(window);this.submenu.cfg.setProperty("xy",[t.left+Ft.rtl(this.$srcElement.outerWidth(),0)-e.scrollLeft(),t.top-e.scrollTop()])},Ct.prototype.hideSubmenu=function(){this.submenu&&this.submenu.$menu.slideUp(100,"swing")},Ct.prototype.initSubmenu=function(){if(this.submenu)this.submenu.render();else{var t=this.config.submenu.itemdata||this.config.submenu;this.submenu=new wt(t,{container:this.$srcElement,clickToHide:this.parent.config.clickToHide}),this.submenu.parent=this.parent}this.submenu.$menu.off().click(function(t){t.preventDefault(),t.stopPropagation()})},Ct.fix=function(t){t.text=u(t.text,t,!0),delete t.icon,t.style&&(t.text='<span style="'+t.style+'">'+t.text+"</span>",delete t.style),t.color&&(t.text='<span style="display:inline-block;width:15px;height:15px;vertical-align:middle;background-color:'+t.color+';">&nbsp</span> '+t.text,delete t.color),t.indent&&(t.text=new Array(t.indent+1).join("&nbsp;")+t.text,delete t.indent),t.handler&&!t.onclick&&(t.onclick=t.handler),"function"==typeof t.onclick&&(t.onclick={fn:t.onclick}),t.submenu&&_t.fix(t.submenu)},Ct);function Ct(t){var i=this;this.config=t,Ct.fix(this.config),this.cfg={setProperty:function(t,e){switch(t){case"obj":case"fn":i.config.onclick[t]=e;default:i.config[t]=e}i.render(i.$srcElement),i.$srcElement.trigger("cfgChanged")},getProperty:function(t){return i.config[t]}}}t.MenuItem=yt;var _t=($t.prototype.initItems=function(t){var e=[[]],i=0;function n(){e[i].length&&(i++,e.push([]))}if(t)for(var s=0;s<t.length;s++){var r=t[s];if(r)if(r instanceof yt)e[i].push(r);else if(Ft.isArray(r)){var o=this.initItems(r);0<o.length&&0<o[0].length&&(n(),e[i]=o[0]),s<t.length-1&&n()}else e[i].push(new yt(r));else n()}return e[i].length||e.pop(),e},$t.prototype.render=function(){var t=this;this.$menu=$j("<div class='asc dropDown'>").addClass(this.config.cssClass).append("<div class='close-btn'>"+Ft.ls(1567)+"</div><div class='header'/><div class='body'/><div class='footer'/>"),this.$menu.find(".close-btn").click(function(){t.hide()}),this.$body=this.$menu.find(">div.body").first(),this.renderItems(),new At(this.$menu,this.$body,function(){t.show()}),this.$menu.appendTo(this.$container)},$t.prototype.renderItems=function(){function t(){var t=null!=e;e=$j("<ul class='dropDownPanel asc-context-menu'>").appendTo(i.$body),t&&e.addClass("top-border")}var e,i=this;this.$body.empty(),t(),this.fixMissingIcon();for(var n=0;n<this.items.length;n++){for(var s=0;s<this.items[n].length;s++){var r=this.items[n][s];r.parent=this,r.groupIndex=n,r.index=s;var o=$j("<li>").appendTo(e);r.render(o)}n<this.items.length-1&&t()}},$t.prototype.fixMissingIcon=function(){for(var t=!1,e=0,i=this.items;e<i.length;e++)for(var n=0,s=i[e];n<s.length;n++)if(0<=(c=s[n]).config.text.indexOf("<img src")){t=!0;break}if(t)for(var r=0,o=this.items;r<o.length;r++)for(var a=0,l=o[r];a<l.length;a++){var c;(c=l[a]).config.text.indexOf("<img src")<0&&(c.config.icon=staticUrl("/global/pics/ui/blank_32.png"),c.config.text=u(c.config.text,c.config,!0),delete c.config.icon)}},$t.prototype.show=function(){this.$menu.attr({tabIndex:0,autofocus:1}).show().focus()},$t.prototype.hide=function(){this.$menu.fadeOut(),$j(".tmp-selected").removeClass("tmp-selected"),this.parent&&this.parent.hide(),this.config.onHide&&this.config.onHide()},$t.prototype.getSubmenus=function(){var n=[];return this.items.forEach(function(t,e,i){t.forEach(function(t,e){!t.submenu&&t.config.submenu&&t.initSubmenu(),t.submenu&&n.push(t.submenu)})}),n},$t.prototype.getItem=function(t,e){return void 0===e&&(e=0),this.items[e]&&this.items[e][t]},$t.prototype.destroy=function(){this.$menu.remove()},$t.fix=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];yt.fix(n)}},$t.convertCombo=function(t,e,i){for(var n,s,r=[],o=0;o<t.length;o++)(n=t[o])&&!Array.isArray(n)&&void 0!==n.value?(s=$j.extend({text:n.name,checked:n.value==e,onclick:{fn:i,obj:n.value}},n),n.classname&&(s.CSS_CLASS_NAME=n.classname,delete s.classname),r.push(s)):r.push([]);return r},$t.addHandler=function(t,e){if(Ft.isArray(t))for(var i=0;i<t.length;i++)$t.addHandler(t[i],e);else t.cmd&&(t.onclick||(t.onclick=function(){e(t)})),t.submenu&&$t.addHandler(t.submenu,e)},$t);function $t(t,e){var i=this;this.config=e,this.config=$j.extend({},{clickToHide:!0,x:0,y:0},e),this.config.container?this.$container=$j(this.config.container):this.$container=$j("<div>").appendTo(document.body),this.items=this.initItems(t),this.render(),this.cfg={setProperty:function(t,e){switch(t){case"xy":i.config.x=e[0],i.config.y=e[1];break;default:i.config[t]=e}switch(t){case"x":case"y":case"xy":i.$menu.css(Ft.rtl({top:i.config.y,left:i.config.x},{top:i.config.y,left:i.config.x-i.$body.width(),right:"unset"}));break;case"header":case"footer":i.$menu.find(">."+t).html(e);break;default:i.$menu.trigger("cfgChanged")}},getProperty:function(t){return i.config[t]}}}t.Menu=_t;var St,wt=(__extends(xt,St=_t),xt.prototype.show=function(t){var e=this;if(t)if(t.clientX)this.cfg.setProperty("xy",[t.clientX,t.clientY]),this.fixOffset();else{var i=this.$trigger=$j(t),n=i.parents(".dropDownBtn");n.length&&n.first().hasClass(".dropDownBtn")&&(i=n.first());var s=i.offset(),r=$j(window);this.cfg.setProperty("xy",[s.left-r.scrollLeft()+Ft.rtl(0,i.outerWidth()),s.top+i.outerHeight()-r.scrollTop()]),this.fixOffset(i)}else this.cfg.setProperty("xy",[this.config.x,this.config.y]),this.fixOffset();window.setTimeout(function(){e.scrollToSelected()},10)},xt.prototype.scrollToSelected=function(){var t=this.$menu.find(".marked");t.length||(t=this.$menu.find(".checked"));var e=t.position();e&&this.$body.scrollTop(e.top-this.$menu.height()/2+t.height())},xt.prototype.fixOffset=function(t){this.parent||St.prototype.show.call(this);var e=[this.config.x,this.config.y],i=this.$menu.offset(),n=$j(window),s=e[0]+this.$menu.outerWidth()-document.body.clientWidth,r=1==Ft.rtl(0,1);0<s?e[0]-=s:r&&(s=e[0]-this.$menu.outerWidth())<0&&(e[0]-=s),this.$body.css("max-height",""),n=$j(window);var o=null!=this.parent,a=!1,l={available:n.height(),menu:this.$menu.outerHeight(),body:this.$body.height(),top:i.top-n.scrollTop(),edubar:0,refEl:0},c=l.top+l.menu-l.available;if(0<c){l.refEl=o?-this.$container.height():t?t.outerHeight():0,l.edubar=$j("#edubar .edubarHeader").outerHeight()||0;var u=l.available-l.top,d=l.top-l.refEl-l.edubar;d>l.menu||u<d?(a=!0,e[1]=d+l.edubar-l.menu,c=l.menu-d,o?e[1]+=(l.menu-l.body)/2:l.refEl||(c+=n.scrollTop()),e[1]=Math.max(e[1],l.edubar+1)):(o&&(e[1]-=(l.menu-l.body)/2),c+=15)}else o&&(e[1]-=(l.menu-l.body)/2);if(0<c){var h=Math.max(30,l.body-c);this.$body.css({"max-height":h+"px","overflow-x":"hidden"}),this.$menu.data("autoheight",!0).css({"overflow-y":"auto"}),""!=Ft.browser&&"firefox"!=Ft.browser||this.$body.width(this.$body.width()+20)}return this.cfg.setProperty("xy",e),a},xt);function xt(t,e){var i=St.call(this,t,e)||this;i.config.container||i.$container.css("position","inherit");var n=i.$container.position();return i.cfg.setProperty("y",[n.top]),i}t.ContextMenu=wt;var At=(kt.prototype.doKeyDown=function(t){var e=this.$dropdown,i=e.is(":visible");switch(t.keyCode){case 32:t.preventDefault(),this.openFn();break;case 13:t.preventDefault(),i?e.find(".marked a").click():this.openFn();break;case 38:case 40:t.preventDefault(),i?this.selectSibling(t,"marked"):this.openFn();break;case 37:var n=e.find(".marked .dropDown:visible");n.length||(n=e.find(".marked").closest(".dropDown").not(e)),n.length||(n=e.find(".dropDown:visible")),n.hide().find(".marked").removeClass("marked"),e.find(".marked").length||n.closest("li").addClass("marked"),e.find(".marked").closest(".dropDown").focus();break;case 39:e.find(".marked.submenu, .focused.submenu").click();break;case 27:t.stopPropagation(),t.preventDefault(),e.prev().click().focus();break;default:var s=this.getLetterPressed(t);if(s){t.preventDefault(),i||this.openFn();var r=e.data(),o=0;r.lastSearched+1e3>Date.now()&&(s=r.keyword+s),1<s.length&&s[0]==s[1]&&s[0]!=s[s.length-1]&&(s=s[s.length-1]),e.data({lastSearched:Date.now(),keyword:s}),1<s.length&&s[0]==s[1]&&(o=s.length-1,s=s[0]),this.search(s,o)}}},kt.prototype.getLetterPressed=function(t){var e="";return t.ctrlKey||t.altKey||(47<t.keyCode&&t.keyCode<57||95<t.keyCode&&t.keyCode<106?e+=95<t.keyCode?t.keyCode-96:t.keyCode-48:64<t.keyCode&&t.keyCode<91&&(e=String.fromCharCode(t.keyCode).toLowerCase())),e},kt.prototype.search=function(n,t){void 0===t&&(t=0);var e=this.$dropdown.find("li:visible").removeClass("marked").map(function(t,e){var i=$j(e).text().toLowerCase().trim();if(0==(i=Ft.removeDiacritics(i)).search(n))return e});if(e.length){var i=$j(e.get(Math.min(t%e.length)));i.addClass("marked"),this.$dropdown.scrollTop(0);var s=i.offset().top-this.$dropdown.offset().top-i.height()/2;this.$dropdown.scrollTop(Math.max(0,s))}},kt.prototype.selectSibling=function(t,e){var i=this.$dropdown.find("."+e);i.removeClass(e);var n=this.$dropdown.find("LI:visible"),s=n.index(i)+1;38==t.keyCode&&(s-=2),s=Math.min(s,n.length-1),s=Math.max(s,0);var r=n.eq(s).addClass(e).focus(),o=r.position(),a=this.$dropdown.scrollTop(),l=this.$dropdown.height(),c=r.height()/2;o&&o.top&&(o.top<0||o.top+c>l)&&(38==t.keyCode?this.$dropdown.scrollTop(a+c+o.top-l):this.$dropdown.scrollTop(a+o.top-c))},kt);function kt(t,e,i){var n=this;this.$dropdown=e,this.openFn=i,$j(t).keydown(function(t){9!=t.keyCode&&n.doKeyDown(t)})}t.MenuKeyNavigation=At;var jt=(Tt.prototype.up=function(){var t=this.$el.val(),e="";e=7==t.length&&"#"==t[0]?this.prefix+"<div style='display:inline-block;width:10px;height:10px;border:1px solid black;vertical-align:-2px;background-color:"+t+"'></div>":this.prefix+"",this.btn.label_html(e)},Tt.prototype.pick_palette=function(){var e=this;this.$d_pick.empty();var t,i,n=$j("<table>").appendTo(this.$d_pick),s=$j("<tbody>").appendTo(n);this.cds.length=0;for(var r=Tt.palette,o=0;o<r.length;o++)o%7==0&&(t=$j("<tr>").appendTo(s)),i=$j("<td>").appendTo(t).css("background-color",r[o]).attr("title",r[o]).data("color",r[o]).click(function(t){e.setV($j(t.target).data("color")+""),e.btn.menu.hide()}),this.cds.push(i);this.options.morecolors&&$j("<a href='#'>").text(Ft.ls(1239)).appendTo($j("<div style='text-align:right'>").appendTo(this.$d_pick)).click(function(t){e.pick_more(),t.stopPropagation(),t.preventDefault()})},Tt.prototype.pick_more=function(){var s=this;this.$d_pick.empty(),this.cds.length=0,$j("<div>").appendTo(this.$d_pick).ColorPicker({color:this.val(),flat:!0,showThemeColors:!1,showSubmitBtn:!1,showOrigSubmitBtn:!0,onSubmit:function(t,e,i,n){s.setV(("#"+e).toUpperCase()),s.btn.menu.hide()}}),$j("<a href='#'>").text(Ft.ls(4060)).appendTo($j("<div style='text-align:right'>").appendTo(this.$d_pick)).click(function(t){s.pick_palette(),t.stopPropagation(),t.preventDefault()})},Tt.prototype.val=function(){return this.$el.val()},Tt.prototype.setV=function(t){var e=this.$el.val()!=t;this.$el.val(t),this.$tf&&this.$tf.val(t);for(var i=0;i<this.cds.length;i++){var n=this.cds[i];n.toggleClass("selected",n.data("color")+""==t)}this.btn_nc&&this.btn_nc.check(""==t),this.up(),e&&this.ASC_ce.fire()},Tt.prototype.renderMenu=function(){var t=this,e=this.btn.menu,i=e.$menu.empty().css("padding","0px"),n=$j("<div>").addClass("asc-colorpicker").appendTo(i);i.off(),this.$tf=$j('<input type="text">').appendTo(n).on("blur change",function(){t.setV(Ft.trim(t.$tf.val()))}),this.$d_pick=$j("<div style='margin: 5px 0'>").appendTo(n),""==this.val()||0<=Tt.palette.indexOf(this.val())||!this.options.morecolors?this.pick_palette():this.pick_more(),this.options.nocolor&&(this.btn_nc=new s(n,Ft.ls(1642),{onclick:function(){t.setV(""),e.hide(),t.ASC_ce.fire()}}),this.btn_nc.button.$element.add(this.btn_nc.button.$element.parent()).css("width","100%")),this.setV(this.val())},Tt.palette=["#FFFFFF","#CCCCCC","#C0C0C0","#999999","#666666","#333333","#000000","#FFCCCC","#FF6666","#FF0000","#CC0000","#990000","#660000","#330000","#FFCC99","#FF9966","#FF9900","#FF6600","#CC6600","#993300","#663300","#FFFF99","#FFFF66","#FFCC66","#FFCC33","#CC9933","#996633","#663333","#FFFFCC","#FFFF33","#FFFF00","#FFCC00","#999900","#666600","#333300","#99FF99","#66FF99","#33FF33","#33CC00","#009900","#006600","#003300","#99FFFF","#33FFFF","#66CCCC","#00CCCC","#339999","#336666","#003333","#CCFFFF","#66FFFF","#33CCFF","#3366FF","#3333FF","#000099","#000066","#CCCCFF","#9999FF","#6666CC","#6633FF","#6600CC","#333399","#330099","#FFCCFF","#FF99FF","#CC66CC","#CC33CC","#993399","#663366","#330033"],Tt);function Tt(t,e,i){var n=this;this.options=i,this.$d_pick=null,this.cds=[],this.prefix="",this.$el=$j("<input>").attr("type","hidden").val(""+e).appendTo(t),this.ASC_ce=new Ft.ASC_ce(this.$el),this.btn=new o({container:$j("<span>").appendTo(t),label:"",menu:[],style:i.style,onclick:function(){n.renderMenu()}}),this.options.label&&(this.prefix="<span style='margin-right:5px'>"+Ft.escapeHTML(this.options.label)+"</span>"),this.up()}t.ColorPicker=jt;var Mt=(It.prototype.start=function(t){var e=this;void 0===t&&(t=0);for(var i=Date.now();t<this.todoFnList.length;t++){if(!this.checkSafetyCounter())return;var n=this.todoFnList[t];if("function"==Ft.type(n)?n():this.status(-1,n),t<this.todoFnList.length-1&&Date.now()-i>this.options.stepTime){setTimeout(function(){e.safetyCounter++,e.checkSafetyCounter()&&(e.setAutoTitle(t,e.todoFnList.length-1),e.status(t/e.todoFnList.length),e.start(t+1))},10);break}}t>=this.todoFnList.length-1&&this.stop()},It.prototype.stop=function(){if(!this.stopped)try{this.dlg.hide(),this.options.onStop&&this.options.onStop()}catch(t){console.log(t)}},It.prototype.status=function(t,e){e&&(this.options.title=e,this.dlg.setHeader(e)),0<=t&&It.update(this.dlg.$bd,100*t,this.options)},It.update=function(t,e,i){var n=It.getOrCreateBar(t);i=$j.extend({stepTime:isNaN(i)?1e3:i,animate:"linear"},i);var s=e/100*(n.parent().width()+1);i.subtitle&&$j(".subtitle",t).text(i.subtitle),0<s?(Math.ceil(s)<n.width()&&n.width(0),i.animate?n.animate({width:Math.ceil(s)+"px"},i.stepTime,i.animate):n.width(Math.ceil(s))):n.width(0)},It.getOrCreateBar=function(t){if($j(t).is(":empty")){var e=$j("<div>").appendTo(t).css({display:"inline-block",width:"90%",border:"1px solid black",overflow:"hidden"});return $j("<div class='subtitle'>").appendTo(t),$j("<div>").appendTo(e).css({display:"block",height:"8px",backgroundColor:"rgb(64, 152, 64)",width:"0"})}return $j("div > div",t)},It.prototype.checkSafetyCounter=function(){return!(this.stopped||this.safetyCounter>=this.safetyCounterMax&&(console.log("safety counter reached its maximum",this.safetyCounter),this.stop(),1))},It.prototype.setAutoTitle=function(t,e){var i=this.options.title+" "||"";switch(this.options.showInfoProgress){case"counter":i+=t+" / "+e;break;case"percentage":i+=Math.round(t/e*100)+" %";break;default:i=""}i&&this.dlg.setHeader(i)},It);function It(t,e){var i=this;this.todoFnList=t,this.options=e,this.safetyCounterMax=50,this.dlg=new Ft.ui.Dialog({resizable:!1,draggable:!1,width:"250px",title:Ft.ls(2568)+"...",show:!0,buttons:[{text:Ft.ls(1038),onclick:function(){i.stop(),i.options.onCancel&&i.options.onCancel()}}]}),this.options=$j.extend({stepTime:500},e),this.safetyCounter=0,this.status(0,this.options.title),this.todoFnList&&this.todoFnList.length&&this.start()}t.ProgressBar=Mt;function Dt(t,e){var u=this;void 0===e&&(e={}),this.vertical=!1,this.$div=$j(t),this.$div.hasClass("flex-split-pane")||(this.$div=$j("<div class='flex-split-pane'>").appendTo(t));var i=5;e.size&&(i=e.size),e.vertical&&(this.vertical=!!e.vertical),e.onmoved&&this.$div.on("moved",e.onmoved);var n=this.vertical?"width":"height";this.$div.css(n,i+"px"),this.$div.addClass(this.vertical?"vertical":"horizontal"),this.$div.mousedown(function(e){var s=0,r=u.vertical?"left":"top",o=u.vertical?"width":"height";function a(t){s=u.vertical?t.pageX-e.pageX:t.pageY-e.pageY,t.stopPropagation(),t.preventDefault(),u.$div.css(r,s+"px")}u.$div.addClass("dragging");var l=[u.$div.prev(),u.$div.next()],c=function(){if($j(document).off("mousemove",a).off("mouseup",c),u.$div.css(r,""),u.$div.removeClass("dragging"),0!=s){for(var t=0;t<2;t++){var e=l[t];if(!parseInt(e.css("flex-grow"))){var i=parseInt(e.css(o)),n=0==t?i+s:i-s;n=Math.max(n,20),e.css(o,n+"px")}}u.$div.trigger("moved")}};$j(document).mousemove(a).mouseup(c)})}t.FlexSplitPane=Dt}(Et=Ft.ui||(Ft.ui={}))}(ASC=ASC||{}),ASC.setModuleSourceFunc("/asc/edurequest.js",function(t,require,e){t.__esModule=!0;var o=require("tslib"),i=require("./lib_date"),n=(s.prototype.initRequest=function(t){this.props=t;for(var e=0,i=["edupage","lang","firstDayOfWeek","weekendDays","school_country","school_state","schoolyear_turnover","loggedUser","loggedUserRights","parent_studentid","sort_name_col","jsmodulemode"];e<i.length;e++){var n=i[e];this[n]=t[n]}},s.prototype.getSchoolYear=function(t){void 0===t&&(t=this.timezone_date()),t&&this.schoolyear_turnover||ASC.dieError("8130146806");var e=parseInt(t.substr(0,4));return t.substr(5)<this.schoolyear_turnover&&e--,e},s.prototype.getSchoolYearName=function(t){return t?this.schoolyear_turnover<="02-01"?""+t:t+"/"+(t+1):""},s.prototype.schoolYear_turnOver=function(t){return t+"-"+this.schoolyear_turnover},s.prototype.schoolYear_turnOver_end=function(t){return ASC.date_delta(this.schoolYear_turnOver(t+1),-1)},s.prototype.isAdmin=function(){return"Admin"==this.loggedUser},s.prototype.isUcitel=function(){return"Ucitel"==this.loggedUser.substr(0,6)?this.loggedUser.substr(6):""},s.prototype.isStudent=function(){return"Student"==this.loggedUser.substr(0,7)?this.loggedUser.substr(7):""},s.prototype.isStudentOrParent=function(){return this.isStudent()||this.props.parent_studentid||""},s.prototype.isParent=function(){return"Rodic"==this.loggedUser.substr(0,5)?this.loggedUser.substr(5):""},s.prototype.isGuest=function(){return"Guest"==this.loggedUser.substr(0,5)?this.loggedUser.substr(5):""},s.prototype.isAscAdmin=function(){return!!this.props.ascadmin},s.prototype.isAscDebug=function(){return!!this.props.ascdebug},s.prototype.isAscDevelop=function(){return!!this.props.ascdevelop},s.prototype.isApp=function(){return!!this.props.app},s.prototype.hasRight=function(t){return this.isAdmin()?["limited"].indexOf(t)<0:0<=this.loggedUserRights.indexOf(t)},s.prototype.jeZUS=function(){return!!this.props.jeZUS},s.prototype.isAgenda=function(){return!!this.props.isAgenda},s.prototype.uiError=function(t,e,i){"string"!=typeof e&&ASC.dieError("8358216710"),console.error("Error",t),e&&console.log(e),void 0!==i&&console.log(i);var n=new Error(""+t);throw n.errNumber=t,n.msg=e,n},s.prototype.ls=function(t){return this.edupageLangs&&this.edupageLangs[t]?this.edupageLangs[t]:ASC.ls(t)},s.prototype.lsf=function(t,e){return this.edupageLangs&&this.edupageLangs[t]&&(t=this.edupageLangs[t]),ASC.lsf(t,e)},s.prototype.ttls=function(t){return this.ttlangasc&&this.ttlangasc[t]?this.ttlangasc[t]:ASC.ttls(t)},s.prototype.ttlsf=function(t,e){var i=this.ttls(t);for(var n in e)i=i.replace("%"+n,e[n]);return i},s.prototype.uls=function(t,e){switch(e){case"tt":return this.ttls(t)}return this.ls(t)},s.prototype.localize=function(t){for(var e=0;e<10;e++){var i=/\{(?:|([a-z]{2}):)([0-9]{4})\}/g.exec(t);if(!i)break;t=t.replace(i[0],this.uls(parseInt(i[2]),i[1]))}return t},s.prototype.timezone_date=function(){var t=new Date;return t.getFullYear()+"-"+("00"+(t.getMonth()+1)).slice(-2)+"-"+("00"+t.getDate()).slice(-2)},s.prototype.maindbi=function(r,i){return o.__awaiter(this,void 0,void 0,function(){var n,e,s=this;return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../rpr/dbi")})];case 1:return[4,t.sent().ClientDBI.newInstance(this,function(e){return o.__awaiter(s,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../rpr/server/maindbi")})];case 1:return[2,t.sent().mainDBIAccessor(null,r,{vt_filter:i.vt_filter},e)]}})})},i)];case 2:return n=t.sent(),e={showItemDlg:function(e,i){return o.__awaiter(s,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../rpr/maindbi_ui")})];case 1:return t.sent().showMainDbiItemDlg(r,e,i),[2]}})})},showRemoveDlg:function(e,i){return o.__awaiter(s,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return 1!=i.length?[3,2]:[4,Promise.resolve().then(function(){return require("../rpr/maindbi_ui")})];case 1:return t.sent().showMainDbiRemoveDlg(r,e,i[0]),[3,3];case 2:ASC.dieError("5154220885"),t.label=3;case 3:return[2]}})})},showVyberDlg:function(e,i){return o.__awaiter(s,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../rpr/vyber")})];case 1:return[2,t.sent().showDBIVyberDlg(n,e,i)]}})})}},n.frontend=e,[2,n]}})})},s.prototype.substdbi=function(n,e){return void 0===e&&(e={}),o.__awaiter(this,void 0,void 0,function(){var i=this;return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../rpr/dbi")})];case 1:return[2,t.sent().ClientDBI.newInstance(this,function(e){return o.__awaiter(i,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../substitution/server/substdbi")})];case 1:return[2,t.sent().substDBIAccessor(null,n,e)]}})})},e)]}})})},s.prototype.timetabledbi=function(n,e){return void 0===e&&(e={}),o.__awaiter(this,void 0,void 0,function(){var i=this;return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../rpr/dbi")})];case 1:return[2,t.sent().ClientDBI.newInstance(this,function(e){return o.__awaiter(i,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../timetable/server/ttdbi")})];case 1:return[2,t.sent().timetableDBIAccessor(null,n,e)]}})})},e)]}})})},s.prototype.ttuidocdbi=function(r,i){return void 0===i&&(i={}),o.__awaiter(this,void 0,void 0,function(){var n,e,s=this;return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../rpr/dbi")})];case 1:return[4,t.sent().ClientDBI.newInstance(this,function(e){return o.__awaiter(s,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../timetable/app/server/ttdoc")})];case 1:return[2,t.sent().ttuidocDBIAccessor(null,r,e)]}})})},i)];case 2:return n=t.sent(),e={showItemDlg:function(e,i){return o.__awaiter(s,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../timetable/app/dlg")})];case 1:return[2,t.sent().showItemDlg(r,e,i)]}})})},showRemoveDlg:function(e,i){return o.__awaiter(s,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../timetable/app/dlg")})];case 1:return[2,t.sent().showRemoveDlg(r,e,i)]}})})},showVyberDlg:function(e,i){return o.__awaiter(s,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../timetable/app/ttdoc")})];case 1:return[2,t.sent().showTTDocVyberDlg(n,e,i)]}})})}},n.frontend=e,[2,n]}})})},s.prototype.memoize=function(t,e){var i=this._memoize_cache.get(t);return i||(i=e(),this._memoize_cache.set(t,i)),i},s);function s(){this.props=null,this.edupage="",this.lang="",this.firstDayOfWeek=1,this.weekendDays=[],this.school_country="",this.school_state="",this.schoolyear_turnover="",this.loggedUser="",this.loggedUserRights=[],this.sort_name_col="FSL",this.edupageLangs=null,this.ttlangasc=null,this._memoize_cache=new Map}t.EduRequest=n;var r,a=(r=n,o.__extends(l,r),l);function l(){var t=r.call(this)||this;return t.lib_date=new i.Lib_date(t),r.prototype.initRequest.call(t,ASC.req_props||{}),t}t.EduRequest_Client=a,t.client_req=new a,t.req=t.client_req,ASC.req=t.client_req}),ASC.setModuleSourceFunc("/asc/lib_date.js",function(t,require,e){t.__esModule=!0;var i=(n.prototype.week_firstDayDeltaToMonday=function(){return{6:2,7:1}[this.req.firstDayOfWeek]||0},n.prototype.date_week=function(t){var e=r(t=a(t,this.week_firstDayDeltaToMonday())).getDay()-1;e<0&&(e=6);var i=a(t,3-e),n=i.substr(0,4);return n+"-W"+p(Math.floor(l(i,n+"-01-01")/7)+1,2)},n.prototype.week_start=function(t){var e=a(t.substr(0,4)+"-01-04",7*(parseInt(t.substr(6,2))-1)),i=r(e).getDay()-1;return i<0&&(i=6),a(e,-i-this.week_firstDayDeltaToMonday())},n.prototype.week_end=function(t){return a(this.week_start(t),6)},n.prototype.week_year=function(t){return this.req.getSchoolYear(this.week_end(t))},n.prototype.week_delta=function(t,e){return this.date_week(a(this.week_start(t),7*e))},n.prototype.week_interval_array=function(t,e){for(var i=[],n=t;n<=e;n=this.week_delta(n,1))i.push(n),1e3<=i.length&&ASC.dieError("6721989579");return i},n.prototype.timezone_datetime=function(){return o(new Date)},n.prototype.timezone_date=function(){return this.timezone_datetime().substr(0,10)},n.prototype.timezone_isWeekend=function(t){return ASC.timezone_isWeekend(t)},n.prototype.date_format_date=function(t,e){return void 0===e&&(e=!0),ASC.ASC_date2str(t,e)},n.prototype.date_format_2dates=function(t,e,i){return void 0===i&&(i=!0),ASC.ASC_date2str(t,i&&t.substr(0,4)!=e.substr(0,4))+" - "+ASC.ASC_date2str(e,i)},n.prototype.day_name=function(t,e){if(void 0===e&&(e=!1),"string"==typeof t){if(!t)return"";t=c(t)}var i=(t+6)%7,n=this.req.ls(1703+i);return e&&(n=this.req.ls(9577+i)),n},n.prototype.month_name=function(t,e){void 0===e&&(e={});var i=this.req.ls(1710+t);return e.ucfirst&&(i=i.substr(0,1).toUpperCase()+i.substr(1)),i},n.prototype.date_format_day=function(t,e,i,n){if(void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=!1),!t)return"";var s=this.req,r=s.lang,o=s.props.dtFormats,a="short"==i,l=i?this.day_name(this.date_day(t),a):"",c=t.substr(8,2),u=""+parseInt(c),d=t.substr(5,2),h=parseInt(d),p=""+h,f="";n&&(f=this.month_name(h-1),f+=" ");var v=e?t.substr(0,4):"",g="";switch(o.date){case"dd.mm.yy":"de"==r?(i&&(g=l+", "),g+=c+"."+(f||d)+"."+v):"pl"==r?(i&&(g=l+" "),g+=c+"."+(f||d)+"."+v):(i&&(g=l+" "),g+=c+". "+(f||d)+". "+v);break;case"yy.mm.dd":i&&(g=l+" "),e&&(g+=v+". "),g+=(f||d)+". "+c;break;case"m/d/yy":i&&(g=l+" "),g+=p+"/"+u,e&&(g+="/"+v);break;case"d/m/yy":i&&(g=l+" "),g+=u+"/"+p,e&&(g+="/"+v);break;case"dd/mm/yy":default:i&&(g=l+" "),g+=c+"/"+d,e&&(g+="/"+v)}for(;"."==g[0]||","==g[0];)g=g.substr(1);return g.trim()},n.prototype.date_format_time=function(t,e){return void 0===e&&(e={}),t?this.date_format_day(t.substr(0,10),e.ajRok||null==e.ajRok,e.ajDenSlovom,e.ajMesiacSlovom)+" "+this.date_format_time0(t.substr(11),e):""},n.prototype.date_format_time0=function(t,e){if(void 0===e&&(e={}),!t)return"";var i=this.req.lang,n=e.ajSekundy||void 0===e.ajSekundy,s=e.short,r=t.substr(0,2),o=t.substr(3,2),a=t.substr(6,2),l=parseInt(r);switch(i){case"de":return r+":"+o+(n?":"+a:"");case"en":return(l+11)%12+1+":"+o+(n?":"+a:"")+(s?"":l<12?" am":" pm");default:return l+":"+o+(n?":"+a:"")}},n);function n(t){this.req=t,this.date_day=c,this.datetime_js2sql=o,this.date_delta=a,this.date_diff=l,this.date_interval_array=u}function s(t){return t?p(t.getFullYear(),4)+"-"+p(t.getMonth()+1,2)+"-"+p(t.getDate(),2):""}function r(t){return t?new Date(parseInt(t.substr(0,4),10),parseInt(t.substr(5,2),10)-1,parseInt(t.substr(8,2),10),11):null}function o(t){return t?s(t)+" "+p(t.getHours(),2)+":"+p(t.getMinutes(),2)+":"+p(t.getSeconds(),2):""}function a(t,e){return 10!=t.length&&ASC.dieError("7021064479"),ASC.date_delta(t,e)}function l(t,e){return 10==t.length&&10==e.length||ASC.dieError("4915985971"),ASC.date_diff(t,e)}function c(t){return new Date(parseInt(t.substr(0,4),10),parseInt(t.substr(5,2),10)-1,parseInt(t.substr(8,2),10),11).getDay()}function u(t,e){for(var i=[],n=t;n<=e;n=ASC.date_delta(n,1))i.push(n),5e3<=i.length&&ASC.dieError("0121904859");return i}function d(t,e){var i=12*parseInt(t.substr(0,4))+parseInt(t.substr(5))+e-1;return p(Math.floor(i/12),4)+"-"+p(i%12+1,2)}function h(t){return t+"-01"}function p(t,e){for(t=""+t;t.length<e;)t="0"+t;return t}t.Lib_date=i,t.date_js2sql=s,t.date_sql2js=r,t.datetime_js2sql=o,t.datetime_sql2js=function(t){return t?new Date(parseInt(t.substr(0,4),10),parseInt(t.substr(5,2),10)-1,parseInt(t.substr(8,2),10),parseInt(t.substr(11,2),10),parseInt(t.substr(14,2),10),parseInt(t.substr(17,2),10)):null},t.date_delta=a,t.date_diff=l,t.date_day=c,t.date_interval_array=u,t.date_month=function(t){return t?(10!=t.length&&ASC.dieError("3334885818"),t.substr(0,7)):""},t.month_delta=d,t.month_interval_array=function(t,e){for(var i=[],n=t;n<=e;n=d(n,1))i.push(n),1e3<i.length&&ASC.dieError("7117153443");return i},t.month_datefrom=h,t.month_dateto=function(t){return a(h(d(t,1)),-1)}});